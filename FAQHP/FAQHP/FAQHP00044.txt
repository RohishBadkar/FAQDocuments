var regionsAction;
var currentSelectedRegion;
var gtinEanUnit;
var currentSource;
var TITLES = [ "GTC - Region", "EMEA - Region", "EMEA - SW","NA / LAC - Region", "APAC - Region" ];
var wizardMasterId = '';
var gbu;
var productType;
var reason;
var productApproverGroup;
var gbuData = new Object();
var brandData = new Object();
var productPopup = new Object();
var sosPopup = new Object();
var gtcPopup = new Object();
var emeaPopup = new Object();
var emeaswPopup = new Object();
var nalacPopup = new Object();
var apacPopup = new Object();
var parentBrand;
var measuresIndex = 0;
var jsonObject = new Array();
var tempJsonObject = new Array();
var validationRuleList = new Array();
var errors = new Array();
var formulaList = new Array();
var oldCurrentSource;
var oldStepNumber;
var resetStyle = new Array();
var selectedMeasuresDropdownIds = new Array();
var measuresValue = new Array();
var messageMeasuresName = new Array();
var messageMeasuresValue = new Array();
var currrentClickedIndex;
var completeJsonArr = new Array();
var completeJsonStr = '';
var regionsIndex = 0;
var dynamicTableId = 0;
var isGBUChanged = false;
var isstep1TabEnabled = false;
var isstep2TabEnabled = false;
var isstep3TabEnabled = false;
var isstep4TabEnabled = false;
var isstep5TabEnabled = false;
var isstep6TabEnabled = false;
var productDivisionIdArray = new Array();
var productDivisionCounter = 1;
var isAPSPSPFlagUnchecked = true;
var messsage = "Please enter only numeric values in ";
var isGBUValueChanged = false;
var subRegionArr = new Array();
var userAction = false;
var productErrorArray = new Array();
var sosErrorArray = new Array();
var regionErrorArray = new Array();
var validationErrorMessage = '';
var formulaGroups = new Object();
var longDecimalValueError = "Please enter maximum 4 digits after decimal point in ";
var isGBUError = false;
var isBrandError = false;
var isProductError = false;
var isSOSError = false;
var emptyFields = false;
var editScreen;
var eProductOverrideChckBox = false;
var lineBreak = "\n";
var bulletStyle = "\u2022 " ;
var jqLineBreak = "<br>";
var cancelForCreate = 'Are you sure you want to quit the new product create? All changes will be lost.';
var cancelForUpdate = 'Are you sure you want to quit the product edit? All changes will be lost.';
var selectedSubRegionsDropdownIds = new Array();
var subRegionValue = new Array();
var packagingInfoArray = new Array();
var noSpecialCharchters = "Only alphabets,digits,space,\\\,.,-, (, ),/,\" are allowed in ";
var resetAutocompleteArrayStyle  = new Array();
var errorReturn =  false;

function navigate(nextSource, form1) {
	var json;
	userAction = false;
	errorReturn= false;
	var StepNumberEnum = {
		step1 : 1,
		step2 : 2,
		step3 : 3,
		step4 : 4,
		step5 : 5,
		step6 : 6,
		next : (stepNumber + 1),
		previous : (stepNumber - 1)
	};
	
	if (stepNumber == 1) {
		gbu = $("#gbu option:selected").val();
		productType = $("#productType option:selected").val();
		productCreateUpdateReason = $("#productCreateUpdateReason option:selected").val();
		productApproverGroup = $("#productApproverGroup option:selected").val();
	}
	
	oldCurrentSource = currentSource;
	oldStepNumber = stepNumber;
	
	currentSource = stepNumber;
	stepNumber = StepNumberEnum[nextSource];

	if (currentSource == 1) {
		gbuFunction(false);

	}else if (currentSource == 2) {
		brandFunction(false);
	}
	if (form1 != null) {
		json = JSON.stringify(jsonObject);
		if (currentSource == 1) {
			json = "{" + '"gbuList"' + ":" + json + "}";
			$.each(completeJsonArr, function( index, obj) {
						if("gbuList" in obj){
							completeJsonArr.splice(index,1);
							return false;
						}
					});
			
		} else if (currentSource == 2) {
			json = "{" + '"brandList"' + ":" + json + "}";
					$.each(completeJsonArr, function( index, obj) {
						if("brandList" in obj){
							completeJsonArr.splice(index,1);
							return false;
						}
					});
				
		} else if (currentSource == 3) {
			json = "{" + '"productList"' + ":" + json + "}";
				$.each(completeJsonArr, function( index, obj) {
					if("productList" in obj){
						completeJsonArr.splice(index,1);
						return false;
					}
				});
			
		} else if (currentSource == 4) {
			json = "{" + '"sosList"' + ":" + json + "}";
			$.each(completeJsonArr, function( index, obj) {
					if("sosList" in obj){
						completeJsonArr.splice(index,1);
						return false;
					}
				});
			
		} else if (currentSource == 5) {
			json = "{" + '"regionList"' + ":" + json + "}";
			$.each(completeJsonArr, function( index, obj) {
					if("regionList" in obj){
						completeJsonArr.splice(index,1);
						return false;
					}
				});
		} else if((editScreen === undefined || editScreen === 'copyProduct' || editScreen === 'newSOSForEMEA_APAC') && stepNumber == 7){
				$.confirm({
			    title: 'Confirm',
			    content: 'Is the cost of the product appoved?',
			    buttons: {
			        Yes: function () {
			        	for(var iCounter = 0 ; iCounter < completeJsonArr.length ; iCounter++ ){
			        		if(completeJsonArr[iCounter].brandList != undefined){
			        			completeJsonArr[iCounter]["brandList"][0].costApprovedChckbox = 'Y';
			        			json = "{" + '"brandList"' + ":" + JSON.stringify(completeJsonArr[iCounter]["brandList"]) + "}";
			        			$.each(completeJsonArr, function (index, obj){
									if("brandList" in obj){
											completeJsonArr.splice(index,1);
											return false;
										}
								});
			        		}
			        	}
						completeJsonArr.push(JSON.parse(json));
			        	formValidationFunction(json);
			        	wizardStepAjaxFunction(json,nextSource);
			        },
			        No: function () {
			        	formValidationFunction(json);
			        	wizardStepAjaxFunction(json,nextSource);
			        }
			    }
			});
			return false;
		}
		formValidationFunction(json);
	}
		if(errorReturn != true){
			wizardStepAjaxFunction(json,nextSource);
		}
}

function wizardStepAjaxFunction(json,nextSource){
	if(stepNumber == 6){
		if($('#step1Btn').parent().attr('class') == 'warning-cls' || $('#step2Btn').parent().attr('class') == 'warning-cls' 
			||$('#step3Btn').parent().attr('class') == 'warning-cls' || $('#step4Btn').parent().attr('class') == 'warning-cls'){
			validationError();
			stepNumber = 5;
			return;
		}else if(userAction == true || regionErrorArray.length >0){
			validationError();
			stepNumber = 5;
			return;
		}
	}
	validationRuleList.length = 0;
	errors.length = 0;
	resetStyle.length = 0;
	if(wizardObject[step_03] != ''){
		var l_productList = wizardObject[step_03].productList;
		internalIdString = '';
		for(var iInternalIdCounter = 0 ; iInternalIdCounter < l_productList.length ; iInternalIdCounter++){
				var message = "," + l_productList[iInternalIdCounter].internalProductID;
				internalIdString = internalIdString.concat(message);
		}
		internalIdString = internalIdString + ",";
	}
	$.ajax({
				type : "POST",
				url : "wizardsteps",
				data : {
					"stepNumber" : stepNumber,
					"formData" : json,
					"currentSource" : currentSource,
					"wizardMasterId" : wizardMasterId,
					"completeJsonArr" : JSON.stringify(completeJsonArr),
					"nextSource" : nextSource,
					"editScreen" : editScreen,
					"internalId" : internalIdString
				},
				async : true,
				success : function(data) {
					$("#wizardsteps").html(data);
					if(stepNumber < 7){
						if(wizardObject[step_01] != null && wizardObject[step_01] != '' && stepNumber != 1){
							var gbuHeading = ""
								+ "<ul><li><span>GBU</span>"
								+ wizardObject[step_01]['gbuList'][0].gbu
								+ "</li><li> <span>Product Type</span>"
								+ wizardObject[step_01]['gbuList'][0].productType
								+ "</li><li><span>Product Create/Update Reason</span>"
								+ wizardObject[step_01]['gbuList'][0].productCreateUpdateReason
								+ "</li><li><span>Workflow/Product Approver Group</span>"
								+ wizardObject[step_01]['gbuList'][0].productApproverGroup + "</li></ul>"
								$("#gbuHeading").html(gbuHeading);
						}
						if (stepNumber == 3 && wizardObject[step_03]=='') {
							addProductPopup(null);
						} else if (stepNumber == 4 && wizardObject[step_04]=='') {
							addSOSPopup(null);
						}
						if(stepNumber == 1){
							$("#step1Btn").parent().removeClass("done-cls");
							$("#step1Btn").parent().addClass("edit-cls");
							isstep1TabEnabled = true;
						}
						else if(stepNumber == 2){
							$("#step2Btn").parent().removeClass("done-cls");
							$("#step2Btn").parent().addClass("edit-cls");
							isstep2TabEnabled = true;
						}
						else if(stepNumber == 3){
							$("#step3Btn").parent().removeClass("done-cls");
							$("#step3Btn").parent().addClass("edit-cls");
							isstep3TabEnabled = true;
						}
						else if(stepNumber == 4){
							$("#step4Btn").parent().removeClass("done-cls");
							$("#step4Btn").parent().addClass("edit-cls");
							isstep4TabEnabled = true;
						}
						else if(stepNumber == 5){
							$("#step5Btn").parent().removeClass("done-cls");
							$("#step5Btn").parent().addClass("edit-cls");
							isstep5TabEnabled = true;
						}
						else if(stepNumber == 6){
							$("#step6Btn").parent().removeClass();
							$("#step6Btn").parent().addClass("edit-cls");
							isstep6TabEnabled = true;
						}

						if(currentSource == 1 && stepNumber != currentSource){
							$("#step1Btn").parent().removeClass();
							if(isGBUError == true){
								$("#step1Btn").parent().addClass("warning-cls");
							}else{
								$("#step1Btn").parent().addClass("done-cls");
							}
						}
						else if(currentSource == 2){
							$("#step2Btn").parent().removeClass();
							if(isBrandError == true){
								$("#step2Btn").parent().addClass("warning-cls");
							}else{
								$("#step2Btn").parent().addClass("done-cls");
							}
						}
						else if(currentSource == 3){
							$("#step3Btn").parent().removeClass();
							if(isProductError == true || productErrorArray.indexOf(true) >= 0){
								$("#step3Btn").parent().addClass("warning-cls");
							}else{
								$("#step3Btn").parent().addClass("done-cls");
							}
						}
						else if(currentSource == 4){
							$("#step4Btn").parent().removeClass();
							if(isSOSError == true || sosErrorArray.indexOf(true) >= 0){
								$("#step4Btn").parent().addClass("warning-cls");
							}else{
								$("#step4Btn").parent().addClass("done-cls");
							}
						}
						else if(currentSource == 5){
							$("#step5Btn").parent().removeClass();
							if(isRegionListError == true){
								$("#step5Btn").parent().addClass("warning-cls");
							}else{
								$("#step5Btn").parent().addClass("done-cls");
							}
						}
						else if(currentSource == 6){
							$("#step6Btn").parent().removeClass();
							$("#step6Btn").parent().addClass("done-cls");
						}
						disableEnableTabs();
						if (stepNumber == 1) {
							$("#previous").prop("disabled", true);
							$("#next").prop("disabled", false);
						}else {
							$("#next").prop("disabled", false);
							$("#previous").prop("disabled", false);
						}
						if(stepNumber == 6){
							$('#next').text('Submit');
						}else{
							$('#next').text('next');
						}
					}
					$("#step1Btn").addClass("ui-state-disabled");
					$("#step2Btn").addClass("ui-state-disabled");
					$("#step3Btn").addClass("ui-state-disabled");
					$("#step4Btn").addClass("ui-state-disabled");
					$("#step5Btn").addClass("ui-state-disabled");
					$("#step6Btn").addClass("ui-state-disabled");
				},
				error : function(response, error, errorThrown) {
					console.log(error + " :-: " + response + " :-: "+ errorThrown);
				}
			});
	while (jsonObject.length > 0) {
		jsonObject.pop();
	}
}

function formValidationFunction(json){
	if(currentSource < 6){
		completeJsonArr.push(JSON.parse(json));
	}
	
	var isValid = validate(validationRuleList,completeJsonArr);
	if(!isValid){
		var errorMessage = '';
		$.each(errors, function( index, error) {
			if(currentSource == 1){
				errorMessage = errorMessage + bulletStyle + error.message + jqLineBreak;
			} else {
				errorMessage = errorMessage + bulletStyle + error.message + lineBreak;
			}
			$("#"+error.fieldId).css("border-color","red");
			resetStyle.push(error.fieldId);
			$("[aria-labelledby='select2-"+error.fieldId+"-container']").css("border-color","red");
			resetAutocompleteArrayStyle.push("[aria-labelledby='select2-"+error.fieldId+"-container']");
		});
		if(currentSource == 1){
			$.alert({
				title	: '',
			    content : errorMessage
			});
		}else{
			userAction = confirm(errorMessage + lineBreak + 'Do you still want to proceed?');
		}
		
		if(userAction == false){
			errors.length = 0;
			if(currentSource == 1 || currentSource == 2)
				jsonObject.length = 0;
			currentSource = oldCurrentSource;
			stepNumber = oldStepNumber;
			completeJsonArr.pop();
			errorReturn = true;
			return;
		}
		errors.length = 0;
		resetStyle.length = 0;
	}
	
	if (currentSource == 1) {
		if (userAction == true) {
			isGBUError = true;
		} else {
			isGBUError = false;
		}
		if (json === JSON.stringify(wizardObject[step_01])) {
			json = '';
		} else {
			wizardObject[step_01] = JSON.parse(json);
		}
	} else if (currentSource == 2) {
		if (userAction == true) {
			isBrandError = true;
		} else {
			isBrandError = false;
		}
		if (json === JSON.stringify(wizardObject[step_02])) {
			json = '';
		} else {
			wizardObject[step_02] = JSON.parse(json);
		}
	} else if (currentSource == 3) {
		if (userAction == true || productErrorArray.indexOf(true) >= 0) {
			isProductError = true;
		} else {
			isProductError = false;
		}
		if (json === JSON.stringify(wizardObject[step_03])) {
			json = '';
		} else {
			wizardObject[step_03] = JSON.parse(json);
		}
	} else if (currentSource == 4) {
		if (userAction == true ||sosErrorArray.indexOf(true) >= 0) {
			isSOSError = true;
		} else {
			isSOSError = false;
		}
		if (json === JSON.stringify(wizardObject[step_04])) {
			json = '';
		} else {
			wizardObject[step_04] = JSON.parse(json);
		}
	} else if (currentSource == 5) {
		if (userAction == true) {
			isRegionListError = true;
		}else{
			isRegionListError = false;
		}
		if (json === JSON.stringify(wizardObject[step_05])) {
			json = '';
		} else {
			wizardObject[step_05] = JSON.parse(json);
		}
	}
}

function validationError(){
	
	validationErrorMessage = "There are data issues on below section(s) :" + jqLineBreak + jqLineBreak;
	var validationErrorCounter = 0;
	if ($('#step1Btn').parent().attr('class') == 'warning-cls') {
		validationErrorCounter++;
		validationErrorMessage = validationErrorMessage.concat(validationErrorCounter + ". GBU " + jqLineBreak);
	}
	if ($('#step2Btn').parent().attr('class') == 'warning-cls') {
		validationErrorCounter++;
		validationErrorMessage = validationErrorMessage
				.concat(validationErrorCounter + ". Brand " + jqLineBreak);
	}
	if ($('#step3Btn').parent().attr('class') == 'warning-cls') {
		validationErrorCounter++;
		validationErrorMessage = validationErrorMessage.concat(validationErrorCounter + ". Product " + jqLineBreak);

	}
	if ($('#step4Btn').parent().attr('class') == 'warning-cls') {
		validationErrorCounter++;
		validationErrorMessage = validationErrorMessage.concat(validationErrorCounter + ". SOS " + jqLineBreak);
	}

	if (userAction == true || regionErrorArray.length > 0) {
		validationErrorCounter++;
		validationErrorMessage = validationErrorMessage.concat(validationErrorCounter + ". Region " + jqLineBreak);
	}
	var message = validationErrorMessage.substring(0,
			validationErrorMessage.length - 1);
	$.alert(message);
//	alert(message);
	
}

function disableEnableTabs(){
	if(isstep1TabEnabled){
		$('#step1Btn').removeClass('ui-state-disabled');
	}else{
		$('#step1Btn').addClass('ui-state-disabled');
	}
	
	if(isstep2TabEnabled){
		$('#step2Btn').removeClass('ui-state-disabled');
	}else{
		$('#step2Btn').addClass('ui-state-disabled');
	}
	
	if(isstep3TabEnabled){
		$('#step3Btn').removeClass('ui-state-disabled');
	}else{
		$('#step3Btn').addClass('ui-state-disabled');
	}
	
	if(isstep4TabEnabled){
		$('#step4Btn').removeClass('ui-state-disabled');
	}else{
		$('#step4Btn').addClass('ui-state-disabled');
	}
	
	if(isstep5TabEnabled){
		$('#step5Btn').removeClass('ui-state-disabled');
	}else{
		$('#step5Btn').addClass('ui-state-disabled');
	}
	
	if(isstep6TabEnabled){
		$('#step6Btn').removeClass('ui-state-disabled');
	}else{
		$('#step6Btn').addClass('ui-state-disabled');
	}
}

function fetchLookUpVal(gbu, lookUpType, parentLookUpType, parentLookUpVal, selectId) {
	$('#' + selectId).empty();
	$.ajax({
		type : "POST",
		url : "getBrandLookup",
		data : {
			"gbu" 				: gbu,
			"lookupType" 		: lookUpType,
			"parentLookUpType" 	: parentLookUpType,
			"parentLookUpVal" 	: parentLookUpVal
		},
		async : false,
		success : function(data) {
			var tagType = $('#' + selectId).prop("tagName");
			if(tagType == 'INPUT'){
				$('#' + selectId).val(data);
			}else{
				$('#' + selectId).append($("<option></option>").attr("value", "").text(""));
				$.each(data, function(key, value) {
					if(selectId == 'subRegionNALAC'){
						$('#' + selectId).append($("<option></option>").attr("value", value.replace(/ +/g, "")).text(value));
					}else{
						$('#' + selectId).append($("<option></option>").attr("value", value).text(value));
					}
				});
			}
		},
		error : function(response, error, errorThrown){
			console.log(error + " :-: " + response + " :-: " + errorThrown);
		}
	});
}

function getBrandStrategy(){
	var brandLkpValue = $("#brand").val();
	$.ajax({
		type : "POST",
		url : "getBrandStrategy",
		data : {
			"lookupType" 		: "BRAND",
			"lookupValue"		: brandLkpValue,
			"parentLookUpType" 	: "BRAND STRATEGY"
		},
		async : true,
		success : function(data) {
			$("#brandStrategy").val(data);
		},
		error : function(response, error, errorThrown){
			console.log(error + " :-: " + response + " :-: " + errorThrown);
		}
	});
}

function productDivisionLov(){
	var sbiValue = $("#productSBI").val();
	var acquisitionValue = $('#acquisitionName').val();
	 
		if((acquisitionValue != 'N/A' && acquisitionValue != '') &&(sbiValue != 'N/A' && sbiValue != '')){//both are present
			fetchLookUpVal(null,'PRODUCT_DIVISION','AQSN',acquisitionValue,'productDivision');
		}else if((acquisitionValue == 'N/A' || acquisitionValue == '') &&(sbiValue == 'N/A' || sbiValue == '') ){//both are absent
			fetchLookUpVal(gbu,'PRODUCT_DIVISION',null,null,'productDivision');
		}else if((acquisitionValue == 'N/A' || acquisitionValue == '') && (sbiValue != 'N/A' && sbiValue != '')){//SBI is present
			fetchLookUpVal(null,'PRODUCT_DIVISION','SBI',sbiValue,'productDivision');
		}else if((acquisitionValue != 'N/A' && acquisitionValue != '') && (sbiValue == 'N/A' || sbiValue == '')){//aqsn is present
			fetchLookUpVal(null,'PRODUCT_DIVISION','AQSN',acquisitionValue,'productDivision');
		}else if((acquisitionValue == 'N/A') &&(sbiValue == '') ){
			fetchLookUpVal(gbu,'PRODUCT_DIVISION',null,null,'productDivision');
		}else if((acquisitionValue == '') &&(sbiValue == 'N/A') ){
			fetchLookUpVal(gbu,'PRODUCT_DIVISION',null,null,'productDivision');
		} 
}

function getSOSData(originCode,originDescription){
	$.ajax({
		type : "POST",
		url : "getSOSData",
		data : {
			"originCode" 		: originCode,
			"originDescription"	: originDescription,
		},
		async : true,
		success : function(data){
			if(originCode != ""){
			var isCheckedprocureViaGTC;
			var isCheckedansellPlant;
			if(data[0] == "Y"){
				isCheckedansellPlant = true;
			}else{
				isCheckedansellPlant = false;
			}
			
			if(data[1] == "Y"){
				isCheckedprocureViaGTC = true;
			}else{
				isCheckedprocureViaGTC = false;
			}
			
			if(originCode!= null){
				$("#select2-sourceDescription-container").html(data[2]);
			}else{
				$("#select2-sourceCode-container").html(data[2]);
			}
			
			$("#ansellPlant").prop("checked",isCheckedansellPlant);
			$("#procureViaGTC").prop("checked",isCheckedprocureViaGTC);
			$("#sourceCountry").val(data[3]);
			}else{
				$("#sourceDescription").val("");
				$("#sourceCountry").val("");
				
			        var primaryOriginFlag = $("#primaryOriginFlag");
			        var active = $("#active");

			    	if(primaryOriginFlag.prop("checked")){
			        	$(":checkbox").not(primaryOriginFlag).not(active).prop("checked",false);
			    	}else{
			    		$(":checkbox").not(active).prop("checked",false);
			    	}
			}
		},
		error : function(response, error, errorThrown){
			console.log(error + " :-: " + response + " :-: " + errorThrown);
		}
	});
}

function getGeneratedId(){
	var length = jsonObject.length;
	var internalIdIndexArr = new Array();
	var productDescArr = new Array();
	var action;
	var productTableIndex;
	var newProductIdArray = new Array();
	var newProductTableIndexArray = new Array();
	
	$.each(jsonObject, function( index, obj) {
		if(obj.internalProductID == null || obj.internalProductID == '' || obj.internalProductID == undefined){
			internalIdIndexArr.push(index);
			productDescArr.push(obj.productID);
		}
	});

	if(internalIdIndexArr.length > 0){

		$.each(productDescArr, function(index, obj) {

			$.ajax({
				type 					: "POST",
				url 					: "checkForDuplicateProduct",
				data 					: {
					"productDesc"    	: obj
				},
				async 	: false,
				success : function(data) {
					if(data == true){
						action = confirm(obj + " product already exist. Do you still want to create it?")
					}
					else{
						action = true;
					}
				},
				error : function(response, error, errorThrown) {
					console.log(error + " :-: " + response + " :-: " + errorThrown);
				}

			});
			if(action == true){
				var trId = $(this).parents('tr').attr('id');
				productTableIndex = internalIdIndexArr[index];
				
				$.ajax({
					type 					: "POST",
					url 					: "getGeneratedId",
					data 					: {
					"length"      	   		: 1
					},
					async 	: false,
					success : function(data) {
						jsonObject[productTableIndex].internalProductID = data[0];
						jsonObject[productTableIndex].oracleProductID 	 = data[0];
						if(gbu == "SEXUAL WELLNESS" && !eProductOverrideChckBox){
							jsonObject[productTableIndex].externalProductID = data[0];
							$("#productTable tr:nth("+ ( (productTableIndex*4) + productTableIndex + 1 ) +") td:nth(3)").html(data[0]);
						}
						$("#productTable tr:nth("+ ( (productTableIndex*4) + productTableIndex + 1 ) +") td:nth(1)").html(data[0]);
						$("#productTable tr:nth("+ ( (productTableIndex*4) + productTableIndex + 1 ) +") td:nth(2)").html(data[0]);
						internalIdArr.push(data[0]);
						newProductIdArray.push(data[0]);
						newProductTableIndexArray.push(productTableIndex);
						//saveDraftTask(data);
					},
					error : function(response, error, errorThrown) {
						console.log(error + " :-: " + response + " :-: " + errorThrown);
					}

				});
			}
		});
		
		if(newProductIdArray.length > 0){
			saveDraftTask(newProductIdArray, newProductTableIndexArray);
		}
	}
	else{
		if(internalIdIndexArr.length == 0 && jsonObject.length > 0){
			alert("All Products have Internal Product Ids");
		}else{
			alert("No Products are present inside Product Table");
		}
	}
}

function changeAPSPSPFlag(apsPSPObject){
	if(apsPSPObject.checked){
		isAPSPSPFlagUnchecked = false;
	}else{
		isAPSPSPFlagUnchecked = true;
	}
}

function saveDraftTask(a_internalIdsToSave, a_newProductTableIndexArray){
	var idLength = internalIdArr.length;
	var json = JSON.stringify(jsonObject);
	json = "{" + '"productList"' + ":" + json + "}";
	var productTableIndex;
	$.each(completeJsonArr, function( index, obj) {
		if("productList" in obj){
			completeJsonArr.splice(index,1);
			return false;
		}
	});
	completeJsonArr.push(JSON.parse(json));
	internalIdString = '';
	for(var iInternalIdCounter = 0 ; iInternalIdCounter < idLength ; iInternalIdCounter++){
			var message = "," + internalIdArr[iInternalIdCounter];
			internalIdString = internalIdString.concat(message);
	}
	internalIdString = internalIdString + ",";
	$.ajax({
		type 					: "POST",
		url 					: "saveDraftTask",
		data 					: {
			"jsonObjectData"   	: json,
			"stepNumber"   	   	: 3,
			"wizardMasterId"   	: wizardMasterId,
			"completeJsonArr" 	: JSON.stringify(completeJsonArr),
			"internalIdsToSave"	: JSON.stringify(a_internalIdsToSave),
			"internalId"        : internalIdString,
			"editScreen"		: editScreen

		},
		async 	: false,
		success : function(data) {
			console.log("success");
			$.each(data, function(index, obj) {
				jsonObject[a_newProductTableIndexArray[index]].rowIdBoProduct = obj;
				$("#productTable tr:nth("+ ( (a_newProductTableIndexArray[index]*4) + a_newProductTableIndexArray[index] + 1 ) +") td:nth(17)").html(obj);
			});
			$("#save").prop("disabled", false).removeClass("top-btn");
			$("#save").addClass("top-cancel-btn");
			$("#saveAndClose").prop("disabled", false).removeClass("top-btn");
			$("#saveAndClose").addClass("top-cancel-btn");
		},
		error : function(response, error, errorThrown) {
			console.log(error + " :-: " + response + " :-: " + errorThrown);
		}
	});
}

function gbuFunction(isTemp) {
	gbuData = new Object();
	gbuData.gbu = $("#gbu").val();
	gbuData.productType = $("#productType").val();
	gbuData.productCreateUpdateReason = $("#productCreateUpdateReason").val();
	gbuData.productApproverGroup = $("#productApproverGroup").val();
	if(!isTemp){
		jsonObject.push(gbuData);
	}
	else{
		tempJsonObject.push(gbuData);
	}
}

function displayGbu(){
	var gbuTemp =  jsonData["gbuList"][0].gbu;
	 $('#gbu').val(gbuTemp);
	 fetchLookUpVal(gbu,'PRODUCT TYPE', null, null, 'productType');
	 $('#productType').val(jsonData["gbuList"][0].productType);
	 $('#productCreateUpdateReason').val(jsonData["gbuList"][0].productCreateUpdateReason);
	 fetchLookUpVal(gbuTemp,'WORKFLOW APPR GRP',null,null,'productApproverGroup');
	 $('#productApproverGroup').val(jsonData["gbuList"][0].productApproverGroup);
}

function brandFunction(isTemp) {
	brandData = new Object();
	brandData.brand = $("#brand").val();
	brandData.subBrand = $("#subBrand").val();
	brandData.brandStrategy = $("#brandStrategy").val();
	brandData.styleCode = $("#styleCode").val();
	brandData.acquisitionName = $("#acquisitionName").val();
	brandData.productSBI = $("#productSBI").val();
	brandData.productDivision = $("#productDivision").val();
	brandData.m4Family = $("#m4Family").val();
	brandData.m4ProductGroup = $("#m4ProductGroup").val();
	brandData.m4Category = $("#m4Category").val();
	brandData.launchYear = $("#launchYear").val();
	brandData.ansellStandardUOM = $("#ansellStandardUOM").val();
	brandData.shelfLife = $("#shelfLife").val();
	brandData.sterility = $("#sterility").val();
	brandData.variant = $("#variant").val();
	brandData.inventoryCategory = $("#inventoryCategory").val();
	brandData.inventoryFamily = $("#inventoryFamily").val();
	brandData.productDescSuffix = $("#productDescSuffix").val();
	brandData.cbox1 = $("#cbox1").prop('checked');
	brandData.costApprovedChckbox = $("#costApprovedChckbox").prop('checked');
	if (brandData.cbox1) {
		brandData.cbox1 = "Y";
	} else {
		brandData.cbox1 = "N";
	}
	if(brandData.costApprovedChckbox){
		brandData.costApprovedChckbox = "Y";
	} else {
		brandData.costApprovedChckbox = "N";
	}
	if(!isTemp){
		jsonObject.push(brandData);
	}
	else{
		tempJsonObject.push(brandData);
	}
}

function displayBrand(){
    var brand = jsonData["brandList"][0].brand; 
     $('#brand').val(jsonData["brandList"][0].brand);
    fetchLookUpVal(gbu,'sub brand','brand',brand,'subBrand');
    $('#subBrand').val(jsonData["brandList"][0].subBrand);
    $('#brandStrategy').val(jsonData["brandList"][0].brandStrategy);
    fetchLookUpVal(gbu,'style','brand',brand,'styleCode');
    $('#styleCode').val(jsonData["brandList"][0].styleCode);
    $('#acquisitionName').val(jsonData["brandList"][0].acquisitionName);
    $('#productSBI').val(jsonData["brandList"][0].productSBI);
    productDivisionLov();
    $('#productDivision').val(jsonData["brandList"][0].productDivision);
    var m4Family = jsonData["brandList"][0].m4Family;
    $('#m4Family').val(jsonData["brandList"][0].m4Family);
    fetchLookUpVal(gbu,'M4 Product Group','M4 FAMILY',m4Family,'m4ProductGroup');
    var m4ProdGrp = jsonData["brandList"][0].m4ProductGroup;
    $('#m4ProductGroup').val(jsonData["brandList"][0].m4ProductGroup);
    fetchLookUpVal(gbu,'M4 CATEGORY','M4 Product group',m4ProdGrp,'m4Category');
    $('#m4Category').val(jsonData["brandList"][0].m4Category);
    $('#launchYear').val(jsonData["brandList"][0].launchYear);
    $('#ansellStandardUOM').val(jsonData["brandList"][0].ansellStandardUOM);
    $('#shelfLife').val(jsonData["brandList"][0].shelfLife);
    $('#sterility').val(jsonData["brandList"][0].sterility);
    $('#variant').val(jsonData["brandList"][0].variant);
    $('#inventoryCategory').val(jsonData["brandList"][0].inventoryCategory);
    $('#inventoryFamily').val(jsonData["brandList"][0].inventoryFamily);
    $('#productDescSuffix').val(jsonData["brandList"][0].productDescSuffix);
    if(jsonData["brandList"][0].cbox1 == 'Y'){
           $("#cbox1").prop('checked' , true);
    }
    if(jsonData["brandList"][0].costApprovedChckbox == 'Y'){
    		$("#costApprovedChckbox").prop('checked', true);
    }
}

function isEmpty(productPopup) {
	jQuery.isEmptyObject(productPopup);

	for ( var key in productPopup) {
		if (productPopup.hasOwnProperty(key))
			return false;
	}
	return true;
}

function productActionFunction(a_sourceObject) {
	$(a_sourceObject).next().show();
}

// Close the dropdown if the user clicks outside of it
window.onclick = function(event) {
	
	$(document).mouseup(function (e){
			    var container = $(".dropdown-content");

			    if (!container.is(e.target) // if the target of the click isn't the container...
			        && container.has(e.target).length === 0) // ... nor a descendant of the container
			    {
			        container.hide();
			    }
	});
}

function deleteItem(a_deleteObject, a_deleteElement) {
	var currentIndex = $("table tr").index($(a_deleteElement).closest("tr"));
	if("sos" === a_deleteObject){
		$(a_deleteElement).closest("tr").remove();
		jsonObject.splice(currentIndex-1 , 1);
		sosErrorArray.splice(currentIndex-1 , 1);
	}else if("gtc" === a_deleteObject){
		$("select option[value*=1]").prop('disabled', false).css('background-color', '');
		$("#div_region_gtc").hide();
		$("#div_region_gtc table tr:last td:nth(0)").html("");
		$("#div_region_gtc table tr:last td:nth(1)").html("");
		$("#div_region_gtc table tr:last td:nth(2)").html("");
		$("#div_region_gtc table tr:last td:nth(3)").html("");
		$("#div_region_gtc table tr:last td:nth(4)").html("");
		$("#div_region_gtc table tr:last td:nth(5)").html("");
		$("#div_region_gtc table tr:last td:nth(6)").html("");
		$("#div_region_gtc table tr:last td:nth(7)").html("");
		$("#div_region_gtc table tr:last td:nth(8)").html("");
		$("#div_region_gtc table tr:last td:nth(9)").html("");
		$("#div_region_gtc table tr:last td:nth(10)").html("");
		$("#div_region_gtc table tr:last td:nth(11)").html("");
		$("#div_region_gtc table tr:last td:nth(12)").html("");
		$("#div_region_gtc table tr:last td:nth(13)").html("");
		$("#div_region_gtc table tr:last td:nth(14)").html("");
		$("#div_region_gtc table tr:last td:nth(15)").html("");
		for (var iGtcDataCounter = 0; iGtcDataCounter < jsonObject.length; iGtcDataCounter++) {
			if(jsonObject[iGtcDataCounter].name =='GTC'){
				jsonObject.splice(iGtcDataCounter , 1);
				break;
			}
		}
		for (var ivalidationCounter = 0; ivalidationCounter < regionErrorArray.length; ivalidationCounter++) {
			if(regionErrorArray[ivalidationCounter].name =='GTC'){
				regionErrorArray.splice(ivalidationCounter , 1);
				break;
			}
		}
	}else if("emea" === a_deleteObject){
		$("select option[value*=2]").prop('disabled', false).css('background-color', '');
		$("#div_region_emea").hide();
		$("#div_region_emea table tr:last td:nth(0)").html("");
		$("#div_region_emea table tr:last td:nth(1)").html("");
		$("#div_region_emea table tr:last td:nth(2)").html("");
		$("#div_region_emea table tr:last td:nth(3)").html("");
		$("#div_region_emea table tr:last td:nth(4)").html("");
		for (var iEMEADataCounter = 0; iEMEADataCounter < jsonObject.length; iEMEADataCounter++) {
			if(jsonObject[iEMEADataCounter].name =='EMEA'){
				jsonObject.splice(iEMEADataCounter , 1);
				break;
			}
		}
		for (var ivalidationCounter = 0; ivalidationCounter < regionErrorArray.length; ivalidationCounter++) {
			if(regionErrorArray[ivalidationCounter].name =='EMEA'){
				regionErrorArray.splice(ivalidationCounter , 1);
				break;
			}
		}
	}else if("emea_sw" === a_deleteObject){
		
		$("select option[value*=3]").prop('disabled', false).css('background-color', '');
		$("#div_region_emea_sw").hide();
		$("#div_region_emea_sw table tr:last td:nth(0)").html("");
		$("#div_region_emea_sw table tr:last td:nth(1)").html("");
		for (var iEMEASWDataCounter = 0; iEMEASWDataCounter < jsonObject.length; iEMEASWDataCounter++) {
			if(jsonObject[iEMEASWDataCounter].name =='EMEA-SW'){
				jsonObject.splice(iEMEASWDataCounter , 1);
				break;
			}
		}
		for (var ivalidationCounter = 0; ivalidationCounter < regionErrorArray.length; ivalidationCounter++) {
			if(regionErrorArray[ivalidationCounter].name =='EMEA-SW'){
				regionErrorArray.splice(ivalidationCounter , 1);
				break;
			}
		}
		if(wizardObject[step_01]['gbuList'][0].gbu != 'SEXUAL WELLNESS'){
	    	$('#addRegionOptions option[value="3"]').attr('disabled',true).css('background-color','#ccc');
	    }
	}else if("nalac" === a_deleteObject){
		$("select option[value*=4]").prop('disabled', false).css('background-color', '');
		$("#div_region_na_lac").hide();
		$("#div_region_na_lac table tr:last td:nth(0)").html("");
		$("#div_region_na_lac table tr:last td:nth(1)").html("");
		$("#div_region_na_lac table tr:last td:nth(2)").html("");
		$("#div_region_na_lac table tr:last td:nth(3)").html("");
		$("#div_region_na_lac table tr:last td:nth(4)").html("");
		$("#div_region_na_lac table tr:last td:nth(5)").html("");
		$("#div_region_na_lac table tr:last td:nth(6)").html("");
		$("#div_region_na_lac table tr:last td:nth(7)").html("");
		subRegionArr.splice(0,subRegionArr.length);
		for (var iNALACDataCounter = 0; iNALACDataCounter < jsonObject.length; iNALACDataCounter++) {
			if(jsonObject[iNALACDataCounter].name =='NALAC'){
				jsonObject.splice(iNALACDataCounter , 1);
				break;
			}
		}
		for (var ivalidationCounter = 0; ivalidationCounter < regionErrorArray.length; ivalidationCounter++) {
			if(regionErrorArray[ivalidationCounter].name =='NALAC'){
				regionErrorArray.splice(ivalidationCounter , 1);
				break;
			}
		}
	}else if("apac" === a_deleteObject){
		$("select option[value*=5]").prop('disabled', false).css('background-color', '');
		$("#div_region_apac").hide();
		$("#div_region_apac table tr:last td:nth(0)").html("");
		$("#div_region_apac table tr:last td:nth(1)").html("");
		for (var iAPACDataCounter = 0; iAPACDataCounter < jsonObject.length; iAPACDataCounter++) {
			if(jsonObject[iAPACDataCounter].name =='APAC'){
				jsonObject.splice(iAPACDataCounter , 1);
				break;
			}
		}
		for (var ivalidationCounter = 0; ivalidationCounter < regionErrorArray.length; ivalidationCounter++) {
			if(regionErrorArray[ivalidationCounter].name =='APAC'){
				regionErrorArray.splice(ivalidationCounter , 1);
				break;
			}
		}
	}else if("product" === a_deleteObject){
		$("#productTable tr:nth("+currentIndex+")").remove();
		$("#productTable tr:nth("+currentIndex+")").remove();
		$("#productTable tr:nth("+currentIndex+")").remove();
		if(currentIndex == 1){
			jsonObject.splice(currentIndex-1 , 1);
			productErrorArray.splice(currentIndex-1 , 1);
			internalIdArr.splice(currentIndex-1 , 1);
		}else{
			var x = (currentIndex/5);
			jsonObject.splice(Math.floor(x), 1);
			productErrorArray.splice(Math.floor(x), 1);
			internalIdArr.splice(Math.floor(x) , 1);
		}
		var idLength = internalIdArr.length;
		internalIdString = '' ;
		for(var iInternalIdCounter = 0 ; iInternalIdCounter < idLength ; iInternalIdCounter++){
			var message = "," + internalIdArr[iInternalIdCounter];
			internalIdString = internalIdString.concat(message);
	}
	internalIdString = internalIdString + ",";
	}else if("display" == a_deleteObject){
		var measuresName = $("#productPopup #displayValues #display #dynamicData"+a_deleteElement+" #measuresName"+a_deleteElement).html();
		if(measuresName == "Retail Pack"){
			measuresName = "Retail_Pack";
		}
		$("select option[value*=" + measuresName + "]").prop('disabled', false);
		$("#productPopup #displayValues #display #dynamicData"+a_deleteElement).remove();
		messageMeasuresName.splice(a_deleteElement , 1);
		messageMeasuresValue.splice(a_deleteElement , 1);
		for(var iPackagingInfCounter = 0 ; iPackagingInfCounter < packagingInfoArray.length ;iPackagingInfCounter ++){
			if(packagingInfoArray[iPackagingInfCounter] == measuresName){
				packagingInfoArray.splice(iPackagingInfCounter,1);
				break;
			}
		}
	}else if("subRegionTable" == a_deleteObject){
		var innerTableMeasuresOrSubRegionName = $("#regionspopup #subRegionTable #dynamicData"+a_deleteElement+" #nalacSubRegion_table"+a_deleteElement).html();
		var iSubRegionArrIndex;
		for(var iSubRegionArrayCounter = 0; iSubRegionArrayCounter < subRegionArr.length; iSubRegionArrayCounter++){
			if(subRegionArr[iSubRegionArrayCounter].subRegion == innerTableMeasuresOrSubRegionName){
				iSubRegionArrIndex = iSubRegionArrayCounter;
				break;
			}
		}
		var removedItem = new Array();
		removedItem = subRegionArr.splice(iSubRegionArrIndex ,1);
		innerTableMeasuresOrSubRegionName = innerTableMeasuresOrSubRegionName.replace(/ +/g, "");
		$("#regionspopup #subRegionTable #dynamicData"+a_deleteElement).remove();
		$("select option[value*=" + innerTableMeasuresOrSubRegionName + "]").prop('disabled', false);
	}
	return;
}

function evalRule(lhsType, lhsValue, rhsType, rhsValue, opeartor,snapshot){
	var lhs, rhs, result;

	if(lhsType != '' && lhsType == 'XPATH'){
		lhs = JSON.search(snapshot, lhsValue);
	}else if(lhsType != '' && lhsType == 'CONSTANT'){
		lhs = lhsValue
	}

	if(rhsType != '' && rhsType == 'XPATH'){
		rhs = JSON.search(snapshot, rhsValue);
	}else if(rhsType != '' && rhsType == 'CONSTANT'){
		rhs = rhsValue;
	}
	
	if(opeartor != undefined && opeartor != ''){
		if(opeartor == 'PLUS'){
			result = lhs + rhs;
		}
		else if(opeartor == 'MINUS'){
			result = lhs - rhs;
		}
		else if(opeartor == 'GREATERTHAN'){

		}
		else if(opeartor == 'LEASSTHAN'){

		}
		else if(opeartor == 'GREATERTHANEQUAL'){

		}
		else if(opeartor == 'LESSTHANEQUAL'){

		}
	}else{
		result = lhs;
	}
	
	return result;
}

function validate(validationRuleList,json){
	clearStyle();
	var snapshot = Defiant.getSnapshot(json);
	$.each(validationRuleList, function( index, validationObj) {
		if(validationObj.sequence == ''){
			result = evalRule(validationObj.lhsType, validationObj.lhsValue, validationObj.rhsType, validationObj.rhsValue, validationObj.opeartor,snapshot);
			if(result.length > 0){
				var error = new Object();
				error.message = validationObj.errorMessage;
				error.fieldId = validationObj.fieldName;
				errors.push(error);
			}
		}
		//to be removed if this condition does not arise
		else if(validationObj.sequence != ''){
				result = evalRule(validationObj.lhsType, validationObj.lhsValue, validationObj.rhsType, validationObj.rhsValue, validationObj.opeartor,snapshot);
		}
	});
	
	if(errors.length > 0){
		return false;
	}
	else{
		return true;
	}
}

function clearStyle(){
	$.each(resetStyle, function( index, value) {
		$("#"+value).css("border-color","#ccc");
	});
	
	$.each(resetAutocompleteArrayStyle, function( index, value) {
		$(value).css("border-color","#ccc");
	});
}

function addSubRegionRow(index){
	nalacPopup.subRegion = $('#subRegionNALAC option:selected').text();
	nalacPopup.orgsSubRegion = $('#orgsSubRegionNALAC').val();
		
	var subRegionNameId = "nalacSubRegion_table";
	var subRegionValueId = "nalacOrgsSubRegion_table";
	if(nalacPopup.subRegion == "" || nalacPopup.orgsSubRegion == ""){
		return false;
	}	
	
    if(nalacPopup.subRegion != "" || nalacPopup.orgsSubRegion != ""){
		var displayValue = 
			"<tr id='dynamicData"+regionsIndex+"'>" +
				"<td id='nalacSubRegion_table"+regionsIndex+"'>"+ nalacPopup.subRegion + "</td>" +
				"<td id='nalacOrgsSubRegion_table"+regionsIndex+"'>" + nalacPopup.orgsSubRegion+"</td>"+
				"<td id='nalacrowIdSubRegion_table"+regionsIndex+"' style=\"display: none;\">" + $("#rowIdSubRegion").val() +"</td>"+
				"<td><input type='button' id='editRow' class='edit-btn-cls center-img-cls' name='editRow' value='edit' onclick=\'editInnerTableMeasuresAndSubRegion("+ regionsIndex +",\"nalacSubRegion_table\",\"nalacOrgsSubRegion_table\", \"nalacrowIdSubRegion_table\")\'></td>" +
				"<td><input type='button' id='deleteRow' class='delet-btn-cls center-img-cls' name='deleteRow' value='delete' onclick=\'deleteItem(\"subRegionTable\","+ regionsIndex +")\'></td>" +
			"</tr>";
	}
	$("#displayRegionValues #subRegionTable").append(displayValue);
	regionsIndex++;
		
	if($('#subRegionNALAC option:selected').text() !="" && $("#regionspopup #orgsSubRegionNALAC").val() != ""){
		subRegionObj = new Object();
		subRegionObj.subRegion = $('#subRegionNALAC option:selected').text();
		subRegionObj.orgsInSubRegion = $("#regionspopup #orgsSubRegionNALAC").val();
		subRegionObj.rowIdSubRegion = $("#regionspopup #rowIdSubRegion").val();
		subRegionArr.push(subRegionObj);
		$("select option[value=" + nalacPopup.subRegion.replace(/ +/g, "") + "]").prop('disabled', true);
		$("#subRegionNALAC").val('');
		$("#orgsSubRegionNALAC").val('');
		$("#rowIdSubRegion").val('');
		
	}else{
		return false;
	}
}

function changeGBUFlag(){
	isGBUChanged = true;
}

function filterValidationListByScreenName(v){
	return v.screenName == this;
}



/////////////////////////-----------------REGION starts --------------------------
// there are 16 methods for REGION. showRegionEditor(selectedRegionIndex,rowData) , insertGtcRegionTableFunction() , loadGtcPopupData() , showGtcData() ,
// insertEmeaRegionTableFunction() , loadEMEAPopupData() , showEMEAData() , insertEmeaswRegionTableFunction() , loadEMEASWPopupData() , showEMEASWData() ,
// insertApacRegionTableFunction() , loadAPACPopupData() , showAPACData() , insertNalacRegionTableFunction() , loadNALACPopupData() , showNALACData() 

function showRegionEditor(selectedRegionIndex,rowData){
	jQuery("input").unbind();//added code to unbind the onchange events on region page
	jQuery("select").unbind();//added code to unbind the onchange events on region page
	var myPos = [ $(window).width() / 10.5, $(window).width() / 45.6 ];
	//var selectedRegionIndex = $("#addRegionOptions  option:selected").index();
	title = TITLES[selectedRegionIndex - 1];
	$("#regionspopup")
	.dialog(
			{
				draggable : true,
				closeOnEscape : true,
				resizable : false,
				modal : true,
				cache : false,
				height : 'auto',
				width : '80%',
				title : title,
				dialogClass: 'propopup',
				close : function() {
					validationRuleList = validationRuleList.filter(filterValidationListByScreenName,'region');
					$(this).dialog('close').empty();
					$('#addRegionOptions option:eq(0)').prop('selected', true);
				},
				position : myPos,
				open : function() {
					$('#regionspopup').dialog("option", "title", title);
				},
				buttons : {
					'Cancel' : function() {
						$(this).dialog('close');
						$('#addRegionOptions option:eq(0)').prop('selected', true);
						validationRuleList = validationRuleList.filter(filterValidationListByScreenName,'region');
						if(selectedRegionIndex == 4){
							var isNalacPresent = false;
							for (var iNALACDataCounter = 0; iNALACDataCounter <jsonObject.length; iNALACDataCounter++) {
								if(jsonObject[iNALACDataCounter].name =='NALAC'){
									isNalacPresent = true;
									break;
								}
							}
							if(!isNalacPresent){
								subRegionArr = new Array();
							}
							for (var iNALACDataCounter = 0; iNALACDataCounter < jsonObject.length; iNALACDataCounter++) {
								if(jsonObject[iNALACDataCounter].name =='NALAC'){
									var tempSubRegArr = new Array();
									for(var iCounter = 1 ; iCounter <= $('.nalac-subregion tbody tr').length -1; iCounter++){
										var subRegion = new Object();
										subRegion.subRegion = $('.nalac-subregion tr:nth('+iCounter+') td:nth(0)').html();
										subRegion.orgsInSubRegion = $('.nalac-subregion tr:nth('+iCounter+') td:nth(1)').html();
										if(iCounter-1 < subRegionArr.length && subRegionArr[iCounter -1].rowIdSubRegion != ''){
											subRegion.rowIdSubRegion = subRegionArr[iCounter -1].rowIdSubRegion;
										}else{
											subRegion.rowIdSubRegion = "";
										}
										tempSubRegArr.push(subRegion);
									}
									subRegionArr = tempSubRegArr;
									selectedSubRegionsDropdownIds = subRegionArr;
									jsonObject[iNALACDataCounter].subRegList = subRegionArr;
									break;
								}
							}
						}
					},
					'Done' : function() {
							var isValid;	
							if (selectedRegionIndex == 1) {
								isValid = insertGtcRegionTableFunction(false);
							} else if (selectedRegionIndex == 2) {
								isValid = insertEmeaRegionTableFunction(false);
							} else if (selectedRegionIndex == 3) {
								isValid = insertEmeaswRegionTableFunction(false);
							} else if (selectedRegionIndex == 4) {
								isValid = insertNalacRegionTableFunction(false,true);
							} else if (selectedRegionIndex == 5){
								isValid = insertApacRegionTableFunction(false);
							}
							if(isValid){
								$(this).dialog('close').empty();
							}
							$('#addRegionOptions option:eq(0)').prop('selected', true);
					}
				}

			}).load('regionsPopup', {
				value : selectedRegionIndex
			});
}

function fetchAccountValues(){
	var brandJSONData = wizardObject[step_02];
	var productDivisionVal = brandJSONData['brandList'][0].productDivision;
	fetchLookUpVal(null, 'VALUE_FOR_GL_CODE', 'PRODUCT_DIVISION', productDivisionVal, 'valueForGLCode');
}

function insertGtcRegionTableFunction(isTemp) {
	var regionName = "GTC";
	gtcPopup = new Object();
	gtcPopup.name = regionName;
	gtcPopup.productStatus = $('label[for=productStatusGTC]').html();
	gtcPopup.primarySellingUOM = $("#primarySellingUOMGTC option:selected").val();
	gtcPopup.secondarySellingUOM = $("#secondarySellingUOMGTC option:selected").val();
	gtcPopup.lowestShippableUOM = $("#lowestShippableUOMGTC option:selected").val();
	gtcPopup.family = $("#familyGTC option:selected").val();
	gtcPopup.group = $("#groupGTC option:selected").val();
	gtcPopup.subGroup = $("#subGroupGTC option:selected").val();
	gtcPopup.subGroupType = $("#subGroupTypeGTC option:selected").val();
	gtcPopup.costOfGoodsSoldAccount = $("#costOfGoodsSoldAccount325GTC").val();
	gtcPopup.salesAccount = $("#salesAccount325GTC").val();
	gtcPopup.expenseAccounts = $("#expenseAccounts325GTC").val();
	gtcPopup.costOfGoodsSoldAccount355 = $("#costOfGoodsSoldAccount355GTC").val();
	gtcPopup.salesAccount355 = $("#salesAccount355GTC").val();
	gtcPopup.expenseAccounts355 = $("#expenseAccounts355GTC").val();
	gtcPopup.divisionAndTransferPriceCategory = $("#divisionAndTransferPriceCategoryGTC").val();
	
	gtcPopup.costOfGoodsSoldAccount325GTCPreField =$("#costOfGoodsSoldAccount325GTCPreField").val();
	gtcPopup.costOfGoodsSoldAccount325GTCPostField =$("#costOfGoodsSoldAccount325GTCPostField").val();
	gtcPopup.salesAccount325GTCPreField =$("#salesAccount325GTCPreField").val();
	gtcPopup.salesAccount325GTCPostField =$("#salesAccount325GTCPostField").val();
	gtcPopup.expenseAccounts325GTCPreField =$("#expenseAccounts325GTCPreField").val();
	gtcPopup.expenseAccounts325GTCPostField =$("#expenseAccounts325GTCPostField").val();
	
	gtcPopup.costOfGoodsSoldAccount355GTCPreField =$("#costOfGoodsSoldAccount355GTCPreField").val();
	gtcPopup.costOfGoodsSoldAccount355GTCPostField =$("#costOfGoodsSoldAccount355GTCPostField").val();
	gtcPopup.salesAccount355GTCPreField =$("#salesAccount355GTCPreField").val();
	gtcPopup.salesAccount355GTCPostField =$("#salesAccount355GTCPostField").val();
	gtcPopup.expenseAccounts355GTCPreField =$("#expenseAccounts355GTCPreField").val();
	gtcPopup.expenseAccounts355GTCPostField =$("#expenseAccounts355GTCPostField").val();
		gtcPopup.regionRowId = $("#regionRowId").val();
	
	gtcPopup.valueForGLCode = $("#valueForGLCode").val();
	
	if(editScreen === "saveNewSOSForNALAC" || editScreen === "newSOSForEMEA_APAC"){
		gtcPopup.flagForEditNALAC = true;
	}
	
	for(var jsonObjectCounter = 0; jsonObjectCounter < jsonObject.length; jsonObjectCounter++){
		if(jsonObject[jsonObjectCounter].name == 'NALAC'){
			if(jsonObject[jsonObjectCounter].primarySellingUOM != gtcPopup.primarySellingUOM && (gtcPopup.primarySellingUOM != undefined || gtcPopup.primarySellingUOM != null)){
				$("#nalacTable tr:nth(1) td:nth(1)").html(gtcPopup.primarySellingUOM);
				jsonObject[jsonObjectCounter].primarySellingUOM = gtcPopup.primarySellingUOM;
			}
			
			if(jsonObject[jsonObjectCounter].secondarySellingUOM != gtcPopup.secondarySellingUOM && (gtcPopup.secondarySellingUOM != undefined || gtcPopup.secondarySellingUOM != null)){
				$("#nalacTable tr:nth(1) td:nth(2)").html(gtcPopup.secondarySellingUOM);
				jsonObject[jsonObjectCounter].secondarySellingUOM = gtcPopup.secondarySellingUOM;
			}
			
			if(jsonObject[jsonObjectCounter].lowestShippableUOM != gtcPopup.lowestShippableUOM && (gtcPopup.lowestShippableUOM != undefined || gtcPopup.lowestShippableUOM != null)){
				$("#nalacTable tr:nth(1) td:nth(3)").html(gtcPopup.lowestShippableUOM);
				jsonObject[jsonObjectCounter].lowestShippableUOM = gtcPopup.lowestShippableUOM;
			}
		}
	}
	
	
	if(!isTemp){
		$("select#addRegionOptions option[value*=1]").prop('disabled', true).css('background-color', '#CCC');
		var tempProductJsonStr = JSON.stringify(gtcPopup);
		tempProductJsonStr = "{" + '"regionList"' +":"+ tempProductJsonStr + "}";
		tempProductJson = JSON.parse(tempProductJsonStr);
		var newValidationList = validationRuleList.filter(filterValidationListByScreenName,'gtc_region');
		var isValid = validate(newValidationList,tempProductJson);
		for(var iRegionErrorCounter =0 ; iRegionErrorCounter< regionErrorArray.length ; iRegionErrorCounter++){
			if(regionErrorArray[iRegionErrorCounter] == regionName){
				regionErrorArray.splice(iRegionErrorCounter , 1);
			}
		}
		regionErrorArray.push(regionName);
		if(!isValid){
			var errorMessage = '';
			$.each(errors, function( index, error) {
				errorMessage = errorMessage + bulletStyle + error.message + lineBreak;
				$("#"+error.fieldId).css("border-color","red");
				resetStyle.push(error.fieldId);
				$("[aria-labelledby='select2-"+error.fieldId+"-container']").css("border-color","red");
				resetAutocompleteArrayStyle.push("[aria-labelledby='select2-"+error.fieldId+"-container']");
			});
			userAction = confirm(errorMessage + lineBreak + 'Do you still want to proceed?');
			if(userAction == false){
				errors.length = 0;
				for(var iRegionErrorCounter =0 ; iRegionErrorCounter< regionErrorArray.length ; iRegionErrorCounter++){
					if(regionErrorArray[iRegionErrorCounter] == regionName){
						regionErrorArray.splice(iRegionErrorCounter , 1);
					}
				}
				return false;
			}
		}else{
			for(var iRegionErrorCounter =0 ; iRegionErrorCounter< regionErrorArray.length ; iRegionErrorCounter++){
				if(regionErrorArray[iRegionErrorCounter] == regionName){
					regionErrorArray.splice(iRegionErrorCounter , 1);
				}
			}
		}
		validationRuleList = validationRuleList.filter(filterValidationListByScreenName,'region');
		errors.length = 0;
		resetStyle.length = 0;

		$('#gtcTable tr:nth(1) td:nth(0)').html(gtcPopup.productStatus);
		//$('#gtcTable tr:nth(1) td:nth(1)').html(gtcPopup.productStatus325);
		$('#gtcTable tr:nth(1) td:nth(1)').html(gtcPopup.primarySellingUOM);
		$('#gtcTable tr:nth(1) td:nth(2)').html(gtcPopup.secondarySellingUOM);
		$('#gtcTable tr:nth(1) td:nth(3)').html(gtcPopup.lowestShippableUOM);
		$('#gtcTable tr:nth(1) td:nth(4)').html(gtcPopup.family);
		$('#gtcTable tr:nth(1) td:nth(5)').html(gtcPopup.group);
		$('#gtcTable tr:nth(1) td:nth(6)').html(gtcPopup.subGroup);
		$('#gtcTable tr:nth(1) td:nth(7)').html(gtcPopup.subGroupType);
		
		$('#gtcTable tr:nth(1) td:nth(8)').html(gtcPopup.costOfGoodsSoldAccount);
		$('#gtcTable tr:nth(1) td:nth(9)').html(gtcPopup.costOfGoodsSoldAccount355);
		$('#gtcTable tr:nth(1) td:nth(10)').html(gtcPopup.salesAccount);
		$('#gtcTable tr:nth(1) td:nth(11)').html(gtcPopup.salesAccount355);
		$('#gtcTable tr:nth(1) td:nth(12)').html(gtcPopup.expenseAccounts);
		$('#gtcTable tr:nth(1) td:nth(13)').html(gtcPopup.expenseAccounts355);
		
		$('#gtcTable tr:nth(1) td:nth(14)').html(gtcPopup.divisionAndTransferPriceCategory);
		$('#gtcTable tr:nth(1) td:nth(15)').html(gtcPopup.regionRowId);
		if(jsonObject.length <= 0){
			jsonObject.push(gtcPopup);
		}else{
			for (var iGtcDataCounter = 0; iGtcDataCounter < jsonObject.length; iGtcDataCounter++) {
				if(jsonObject[iGtcDataCounter].name =='GTC'){
					jsonObject.splice(iGtcDataCounter , 1);
					break;
				}
			}
			jsonObject.push(gtcPopup);
		}
		$("#div_region_gtc").show(); 
	}
	else{
		tempJsonObject.push(gtcPopup);
	}
	return true;
}

function loadGtcPopupData(){
	if(editScreen === "saveNewSOSForNALAC"){
		$('#primarySellingUOMGTC').prop('disabled',true);
		$('#secondarySellingUOMGTC').prop('disabled',true);
		$('#lowestShippableUOMGTC').prop('disabled',true);
	}
	
	$('label[for=productStatusGTC]').html($('#gtcTable tr:nth(1) td:nth(0)').text());
	
	if(isGBUChanged == false){
			$("#regionspopup #primarySellingUOMGTC").val($('#gtcTable tr:nth(1) td:nth(1)').text());
		}
	if(isAPSPSPFlagUnchecked == false){
			$("#regionspopup #primarySellingUOMGTC").val($('#gtcTable tr:nth(1) td:nth(1)').text());
	}else{
		if(gbu == 'SEXUAL WELLNESS'){
			$("#regionspopup #primarySellingUOMGTC").val($('#gtcTable tr:nth(1) td:nth(1)').text());
		}else{
			$("#regionspopup #primarySellingUOMGTC").val("CASE");
		}
	}
	
	$("#regionspopup #secondarySellingUOMGTC").val($('#gtcTable tr:nth(1) td:nth(2)').text());
	$("#regionspopup #lowestShippableUOMGTC").val($('#gtcTable tr:nth(1) td:nth(3)').text());
	fetchLookUpVal(null, 'Global Proc Cat Family', null, null, 'familyGTC');
	$("#regionspopup #familyGTC").val($('#gtcTable tr:nth(1) td:nth(4)').text());
	var familyGTC = $('#gtcTable tr:nth(1) td:nth(4)').text();
	fetchLookUpVal(null,'Global Proc Cat Group','Global Proc Cat Family ',familyGTC,'groupGTC');
	$("#regionspopup #groupGTC").val($('#gtcTable tr:nth(1) td:nth(5)').text());
	var groupGTC = $('#gtcTable tr:nth(1) td:nth(5)').text();
	fetchLookUpVal(null, 'Global Proc Cat Sub Group', 'Global Proc Cat Group' ,groupGTC, 'subGroupGTC');
	$("#regionspopup #subGroupGTC").val($('#gtcTable tr:nth(1) td:nth(6)').text());
	var subGroupGTC = $('#gtcTable tr:nth(1) td:nth(6)').text();
	fetchLookUpVal(null,'Global Proc Cat Sub Group Type','Global Proc Cat Sub Group',subGroupGTC,'subGroupTypeGTC');
	$("#regionspopup #subGroupTypeGTC").val($('#gtcTable tr:nth(1) td:nth(7)').text());
	
	$("#regionspopup #costOfGoodsSoldAccount325GTC").val($('#gtcTable tr:nth(1) td:nth(8)').text());
	$("#regionspopup #salesAccount325GTC").val($('#gtcTable tr:nth(1) td:nth(10)').text());
	$("#regionspopup #expenseAccounts325GTC").val($('#gtcTable tr:nth(1) td:nth(12)').text());
	$("#regionspopup #costOfGoodsSoldAccount355GTC").val($('#gtcTable tr:nth(1) td:nth(9)').text());
	$("#regionspopup #salesAccount355GTC").val($('#gtcTable tr:nth(1) td:nth(11)').text());
	$("#regionspopup #expenseAccounts355GTC").val($('#gtcTable tr:nth(1) td:nth(13)').text());
	
	$("#regionspopup #divisionAndTransferPriceCategoryGTC").val($('#gtcTable tr:nth(1) td:nth(14)').text());
	$("#regionspopup #regionRowId").val($('#gtcTable tr:nth(1) td:nth(15)').text());
}

function showGtcData(){
	
	$("select#addRegionOptions option[value*=1]").prop('disabled', true).css('background-color', '#CCC');
	
	fetchAccountValues();
	
	jsonData[iRegionCounter].costOfGoodsSoldAccount325GTCPreField =$("#costOfGoodsSoldAccount325GTCPreField").val();
	jsonData[iRegionCounter].costOfGoodsSoldAccount325GTCPostField =$("#costOfGoodsSoldAccount325GTCPostField").val();
	jsonData[iRegionCounter].salesAccount325GTCPreField =$("#salesAccount325GTCPreField").val();
	jsonData[iRegionCounter].salesAccount325GTCPostField =$("#salesAccount325GTCPostField").val();
	jsonData[iRegionCounter].expenseAccounts325GTCPreField =$("#expenseAccounts325GTCPreField").val();
	jsonData[iRegionCounter].expenseAccounts325GTCPostField =$("#expenseAccounts325GTCPostField").val();
	
	jsonData[iRegionCounter].costOfGoodsSoldAccount355GTCPreField =$("#costOfGoodsSoldAccount355GTCPreField").val();
	jsonData[iRegionCounter].costOfGoodsSoldAccount355GTCPostField =$("#costOfGoodsSoldAccount355GTCPostField").val();
	jsonData[iRegionCounter].salesAccount355GTCPreField =$("#salesAccount355GTCPreField").val();
	jsonData[iRegionCounter].salesAccount355GTCPostField =$("#salesAccount355GTCPostField").val();
	jsonData[iRegionCounter].expenseAccounts355GTCPreField =$("#expenseAccounts355GTCPreField").val();
	jsonData[iRegionCounter].expenseAccounts355GTCPostField =$("#expenseAccounts355GTCPostField").val();
	
	jsonData[iRegionCounter].valueForGLCode = $("#valueForGLCode").val();
	
	populateDataByFormula(jsonData[iRegionCounter]);
	
	$('#gtcTable tr:nth(1) td:nth(0)').html(jsonData[iRegionCounter].productStatus);
	$('#gtcTable tr:nth(1) td:nth(1)').html(jsonData[iRegionCounter].primarySellingUOM);
	$('#gtcTable tr:nth(1) td:nth(2)').html(jsonData[iRegionCounter].secondarySellingUOM);
	$('#gtcTable tr:nth(1) td:nth(3)').html(jsonData[iRegionCounter].lowestShippableUOM);
	$('#gtcTable tr:nth(1) td:nth(4)').html(jsonData[iRegionCounter].family);
	$('#gtcTable tr:nth(1) td:nth(5)').html(jsonData[iRegionCounter].group);
	$('#gtcTable tr:nth(1) td:nth(6)').html(jsonData[iRegionCounter].subGroup);
	$('#gtcTable tr:nth(1) td:nth(7)').html(jsonData[iRegionCounter].subGroupType);

	$('#gtcTable tr:nth(1) td:nth(8)').html(jsonData[iRegionCounter].costOfGoodsSoldAccount);
	$('#gtcTable tr:nth(1) td:nth(9)').html(jsonData[iRegionCounter].costOfGoodsSoldAccount355);
	$('#gtcTable tr:nth(1) td:nth(10)').html(jsonData[iRegionCounter].salesAccount);
	$('#gtcTable tr:nth(1) td:nth(11)').html(jsonData[iRegionCounter].salesAccount355);
	$('#gtcTable tr:nth(1) td:nth(12)').html(jsonData[iRegionCounter].expenseAccounts);
	$('#gtcTable tr:nth(1) td:nth(13)').html(jsonData[iRegionCounter].expenseAccounts355);
	$('#gtcTable tr:nth(1) td:nth(14)').html(jsonData[iRegionCounter].divisionAndTransferPriceCategory);
	var decodedDivisionAndTransfer = $("<div/>").html(jsonData[iRegionCounter].divisionAndTransferPriceCategory).text();
	$('#gtcTable tr:nth(1) td:nth(15)').html(jsonData[iRegionCounter].regionRowId);
	jsonObject.push(jsonData[iRegionCounter]);
	$("#div_region_gtc").show();
	disbaleProperties(stepNumber);
	if(editScreen === "saveNewForCrossFertilization" || editScreen === "saveUpdateProcurementData"){
		if(jsonData[iRegionCounter].regionRowId){
			$('#gtcTable ').find(".deleteRegion").hide();
		}
	}
}

function insertEmeaRegionTableFunction(isTemp) {
	var regionName = "EMEA";
	emeaPopup = new Object();
	emeaPopup.name = regionName;
	emeaPopup.productStatus = $('label[for=productStatusEMEA]').html();
	emeaPopup.soldToRussia = $("#soldToRussiaEMEA").prop("checked");
	emeaPopup.materialGroup2 = $("#materialGroup2EMEA option:selected").val();
	emeaPopup.russianLabel = $("#russianLabelEMEA option:selected").val();
	emeaPopup.primarySellingUOM = $("#primarySellingUOMEMEA option:selected").val();
	emeaPopup.regionRowId = $("#regionRowId").val();
	if(editScreen === "saveNewSOSForNALAC" || editScreen === "newSOSForEMEA_APAC"){
		emeaPopup.flagForEditNALAC = true;
	}

	if (emeaPopup.soldToRussia) {
		emeaPopup.soldToRussia = "Y";
	} else {
		emeaPopup.soldToRussia = "N";
	}
	if(!isTemp){
		$("select#addRegionOptions option[value*=2]").prop('disabled', true).css('background-color', '#CCC');
		var tempProductJsonStr = JSON.stringify(emeaPopup);
		tempProductJsonStr = "{" + '"regionList"' +":"+ tempProductJsonStr + "}";
		tempProductJson = JSON.parse(tempProductJsonStr);
		var newValidationList = validationRuleList.filter(filterValidationListByScreenName,'emea_region');
		var isValid = validate(newValidationList,tempProductJson);
		for(var iRegionErrorCounter =0 ; iRegionErrorCounter< regionErrorArray.length ; iRegionErrorCounter++){
			if(regionErrorArray[iRegionErrorCounter] == regionName){
				regionErrorArray.splice(iRegionErrorCounter , 1);
			}
		}
		regionErrorArray.push(regionName);
		if(!isValid){
			var errorMessage = '';
			$.each(errors, function( index, error) {
				errorMessage = errorMessage + bulletStyle + error.message + lineBreak;
				$("#"+error.fieldId).css("border-color","red");
				resetStyle.push(error.fieldId);
				$("[aria-labelledby='select2-"+error.fieldId+"-container']").css("border-color","red");
				resetAutocompleteArrayStyle.push("[aria-labelledby='select2-"+error.fieldId+"-container']");
				
			});
			userAction = confirm(errorMessage + lineBreak + 'Do you still want to proceed?');
			if(userAction == false){
				errors.length = 0;
				for(var iRegionErrorCounter =0 ; iRegionErrorCounter< regionErrorArray.length ; iRegionErrorCounter++){
					if(regionErrorArray[iRegionErrorCounter] == regionName){
						regionErrorArray.splice(iRegionErrorCounter , 1);
					}
				}
				return false;
			}
		}else{
			for(var iRegionErrorCounter =0 ; iRegionErrorCounter< regionErrorArray.length ; iRegionErrorCounter++){
				if(regionErrorArray[iRegionErrorCounter] == regionName){
					regionErrorArray.splice(iRegionErrorCounter , 1);
				}
			}
		}
		validationRuleList = validationRuleList.filter(filterValidationListByScreenName,'region');
		errors.length = 0;
		resetStyle.length = 0;

		$('#emeaTable tr:nth(1) td:nth(0)').html(emeaPopup.productStatus);
		$('#emeaTable tr:nth(1) td:nth(1)').html(emeaPopup.soldToRussia);
		$('#emeaTable tr:nth(1) td:nth(2)').html(emeaPopup.materialGroup2);
		if(emeaPopup.soldToRussia == "N"){
			$('#emeaTable tr:nth(1) td:nth(3)').html(emeaPopup.russianLabel == "");
		}else{
			$('#emeaTable tr:nth(1) td:nth(3)').html(emeaPopup.russianLabel);
		}
		$('#emeaTable tr:nth(1) td:nth(4)').html(emeaPopup.primarySellingUOM);
		$('#emeaTable tr:nth(1) td:nth(5)').html(emeaPopup.regionRowId);
		if(jsonObject.length<=0){
			jsonObject.push(emeaPopup);
		}else{
			for (var iEMEADataCounter = 0; iEMEADataCounter < jsonObject.length; iEMEADataCounter++) {
				if(jsonObject[iEMEADataCounter].name =='EMEA'){
					jsonObject.splice(iEMEADataCounter , 1);
					break;
				}
			}
			jsonObject.push(emeaPopup);
		}
		$("#div_region_emea").show();
	}
	else{
		tempJsonObject.push(emeaPopup);
	}
	return true;
}

function loadEMEAPopupData(){
	$('label[for=productStatusEMEA]').html($('#emeaTable tr:nth(1) td:nth(0)').text());
	$("#regionspopup #soldToRussiaEMEA").attr("checked", ($('#emeaTable tr:nth(1) td:nth(1)').text() == 'Y'));
	fetchLookUpVal(null,'Material Group 2',null,null,'materialGroup2EMEA');
	if($('#emeaTable tr:nth(1) td:nth(2)').text().match('\\|') === null){
		setMaterialGroupValues();
	}else{
		$("#regionspopup #materialGroup2EMEA").val($('#emeaTable tr:nth(1) td:nth(2)').text());
	}
	if($("#regionspopup #soldToRussiaEMEA").prop("checked") == true){
		fetchLookUpVal(null,'RUSSIAN LABEL CODE',null,null,'russianLabelEMEA');
		$("#regionspopup #russianLabelEMEA").val($('#emeaTable tr:nth(1) td:nth(3)').text());
	}
	$("#regionspopup #primarySellingUOMEMEA").val($('#emeaTable tr:nth(1) td:nth(4)').text());
	$("#regionspopup #regionRowId").val($('#emeaTable tr:nth(1) td:nth(5)').text());
}

function setMaterialGroupValues(){
	var materialGroupValues = $("#materialGroup2EMEA>option").map(function() {
		return $(this).val(); 
	});
	var lengthOfMaterialsGroupValues  = materialGroupValues.length;
	for(var materialGroupCounter=0 ; materialGroupCounter < lengthOfMaterialsGroupValues ; materialGroupCounter++){
		var splitValuesOfMaterial = materialGroupValues[materialGroupCounter].split('|');
		if(splitValuesOfMaterial[1] === $('#emeaTable tr:nth(1) td:nth(2)').text()){
			$("#regionspopup #materialGroup2EMEA").val(materialGroupValues[materialGroupCounter]);
		}
	}
}

function showEMEAData(){
	$("select#addRegionOptions option[value*=2]").prop('disabled', true).css('background-color', '#CCC');
	$('#emeaTable tr:nth(1) td:nth(0)').html(jsonData[iRegionCounter].productStatus);
	$('#emeaTable tr:nth(1) td:nth(1)').html(jsonData[iRegionCounter].soldToRussia);
	$('#emeaTable tr:nth(1) td:nth(2)').html(jsonData[iRegionCounter].materialGroup2);
	if(jsonData[iRegionCounter].soldToRussia){
		$('#emeaTable tr:nth(1) td:nth(3)').html(jsonData[iRegionCounter].russianLabel);
	}else{
		$('#emeaTable tr:nth(1) td:nth(3)').html(jsonData[iRegionCounter].russianLabel = "");
	}
	
	$('#emeaTable tr:nth(1) td:nth(4)').html(jsonData[iRegionCounter].primarySellingUOM);
	$('#emeaTable tr:nth(1) td:nth(5)').html(jsonData[iRegionCounter].regionRowId);
	jsonObject.push(jsonData[iRegionCounter]);
	$("#div_region_emea").show();
	disbaleProperties(stepNumber);
	if(editScreen == "saveNewForCrossFertilization" || editScreen == "saveUpdate"){
		if(jsonData[iRegionCounter].regionRowId){
			$('#emeaTable ').find(".deleteRegion").hide();
		}
	}
}

function insertEmeaswRegionTableFunction(isTemp) {
	var regionName = "EMEA-SW";
	emeaswPopup = new Object();
	emeaswPopup.name = regionName;
	emeaswPopup.productStatus = $('label[for=productStatusEMEA_SW]').html();
	emeaswPopup.primarySellingUOM = $("#primarySellingUOMEMEASW option:selected").val();
	emeaswPopup.regionRowId = $("#regionRowId").val();
	if(editScreen === "saveNewSOSForNALAC" || editScreen === "newSOSForEMEA_APAC"){
		emeaswPopup.flagForEditNALAC = true;
	}

	if(!isTemp){
		$("select#addRegionOptions option[value*=3]").prop('disabled', true).css('background-color', '#CCC');
		var tempProductJsonStr = JSON.stringify(emeaswPopup);
		tempProductJsonStr = "{" + '"regionList"' +":"+ tempProductJsonStr + "}";
		tempProductJson = JSON.parse(tempProductJsonStr);
		var newValidationList = validationRuleList.filter(filterValidationListByScreenName,'emea_sw_region');
		var isValid = validate(newValidationList,tempProductJson);
		for(var iRegionErrorCounter =0 ; iRegionErrorCounter< regionErrorArray.length ; iRegionErrorCounter++){
			if(regionErrorArray[iRegionErrorCounter] == regionName){
				regionErrorArray.splice(iRegionErrorCounter , 1);
			}
		}
		regionErrorArray.push(regionName);
		if(!isValid){
			var errorMessage = '';
			$.each(errors, function( index, error) {
				errorMessage = errorMessage + bulletStyle + error.message + lineBreak;
				$("#"+error.fieldId).css("border-color","red");
				resetStyle.push(error.fieldId);
				$("[aria-labelledby='select2-"+error.fieldId+"-container']").css("border-color","red");
				resetAutocompleteArrayStyle.push("[aria-labelledby='select2-"+error.fieldId+"-container']");
			});
			userAction = confirm(errorMessage + lineBreak + 'Do you still want to proceed?');
			if(userAction == false){
				errors.length = 0;
				for(var iRegionErrorCounter =0 ; iRegionErrorCounter< regionErrorArray.length ; iRegionErrorCounter++){
					if(regionErrorArray[iRegionErrorCounter] == regionName){
						regionErrorArray.splice(iRegionErrorCounter , 1);
					}
				}
				return false;
			}
		}else{
			for(var iRegionErrorCounter =0 ; iRegionErrorCounter< regionErrorArray.length ; iRegionErrorCounter++){
				if(regionErrorArray[iRegionErrorCounter] == regionName){
					regionErrorArray.splice(iRegionErrorCounter , 1);
				}
			}
		}
		validationRuleList = validationRuleList.filter(filterValidationListByScreenName,'region');
		errors.length = 0;
		resetStyle.length = 0;
		
		$('#emeaswTable tr:nth(1) td:nth(0)').html(emeaswPopup.productStatus);
		$('#emeaswTable tr:nth(1) td:nth(1)').html(emeaswPopup.primarySellingUOM);
		$('#emeaswTable tr:nth(1) td:nth(2)').html(emeaswPopup.regionRowId);
		if(jsonObject.length<=0){
			jsonObject.push(emeaswPopup);
		}else{
			for (var iEMEASWDataCounter = 0; iEMEASWDataCounter < jsonObject.length; iEMEASWDataCounter++) {
				if(jsonObject[iEMEASWDataCounter].name =='EMEA-SW'){
					jsonObject.splice(iEMEASWDataCounter , 1);
					break;
				}
			}
			jsonObject.push(emeaswPopup);
		}
		$("#div_region_emea_sw").show();
	}else{
		tempJsonObject.push(emeaswPopup)
	}
	return true;
}

function loadEMEASWPopupData(){
	$('label[for=productStatusEMEA_SW]').html($('#emeaswTable tr:nth(1) td:nth(0)').text());
	$("#regionspopup #primarySellingUOMEMEASW").val($('#emeaswTable tr:nth(1) td:nth(1)').text());
	$("#regionspopup #regionRowId").val($('#emeaswTable tr:nth(1) td:nth(2)').text());
}

function showEMEASWData(){
	$("select#addRegionOptions option[value*=3]").prop('disabled', true).css('background-color', '#CCC');
	$('#emeaswTable tr:nth(1) td:nth(0)').html(jsonData[iRegionCounter].productStatus);
	$('#emeaswTable tr:nth(1) td:nth(1)').html(jsonData[iRegionCounter].primarySellingUOM);
	$('#emeaswTable tr:nth(1) td:nth(2)').html(jsonData[iRegionCounter].regionRowId);
	jsonObject.push(jsonData[iRegionCounter]);
	$("#div_region_emea_sw").show();
	disbaleProperties(stepNumber);
	if(editScreen == "saveNewForCrossFertilization"){
		if(jsonData[iRegionCounter].regionRowId){
			$('#emeaswTable ').find(".deleteRegion").hide();
		}
	}
}

function insertApacRegionTableFunction(isTemp) {
	var regionName = "APAC";
	apacPopup = new Object();
	apacPopup.name = regionName;
	apacPopup.productStatus = $('label[for=productStatusAPAC]').html();
	apacPopup.primarySellingUOM = $("#primarySellingUOMAPAC option:selected").val();
	apacPopup.regionRowId = $("#regionRowId").val();
	
	if(editScreen === "saveNewSOSForNALAC" || editScreen === "newSOSForEMEA_APAC"){
		apacPopup.flagForEditNALAC = true;
	}

	if(!isTemp){
		$("select#addRegionOptions option[value*=5]").prop('disabled', true).css('background-color', '#CCC');
		var tempProductJsonStr = JSON.stringify(apacPopup);
		tempProductJsonStr = "{" + '"regionList"' +":"+ tempProductJsonStr + "}";
		tempProductJson = JSON.parse(tempProductJsonStr);
		var newValidationList = validationRuleList.filter(filterValidationListByScreenName,'apac_region');
		var isValid = validate(newValidationList,tempProductJson);
		for(var iRegionErrorCounter =0 ; iRegionErrorCounter< regionErrorArray.length ; iRegionErrorCounter++){
			if(regionErrorArray[iRegionErrorCounter] == regionName){
				regionErrorArray.splice(iRegionErrorCounter , 1);
			}
		}
		regionErrorArray.push(regionName);
		if(!isValid){
			var errorMessage = '';
			$.each(errors, function( index, error) {
				errorMessage = errorMessage + bulletStyle + error.message + lineBreak;
				$("#"+error.fieldId).css("border-color","red");
				resetStyle.push(error.fieldId);
				$("[aria-labelledby='select2-"+error.fieldId+"-container']").css("border-color","red");
				resetAutocompleteArrayStyle.push("[aria-labelledby='select2-"+error.fieldId+"-container']");
			});
			userAction = confirm(errorMessage + lineBreak + 'Do you still want to proceed?');
			if(userAction == false){
				errors.length = 0;
				for(var iRegionErrorCounter =0 ; iRegionErrorCounter< regionErrorArray.length ; iRegionErrorCounter++){
					if(regionErrorArray[iRegionErrorCounter] == regionName){
						regionErrorArray.splice(iRegionErrorCounter , 1);
					}
				}
				return false;
			}
		}else{
			for(var iRegionErrorCounter =0 ; iRegionErrorCounter< regionErrorArray.length ; iRegionErrorCounter++){
				if(regionErrorArray[iRegionErrorCounter] == regionName){
					regionErrorArray.splice(iRegionErrorCounter , 1);
				}
			}
		}
		validationRuleList = validationRuleList.filter(filterValidationListByScreenName,'region');
		errors.length = 0;
		resetStyle.length = 0;
		
		$('#apacTable tr:nth(1) td:nth(0)').html(apacPopup.productStatus);
		$('#apacTable tr:nth(1) td:nth(1)').html(apacPopup.primarySellingUOM);
		$('#apacTable tr:nth(1) td:nth(2)').html(apacPopup.regionRowId);
		if(jsonObject.length<=0){
			jsonObject.push(apacPopup);
		}else{
			for (var iAPACDataCounter = 0; iAPACDataCounter < jsonObject.length; iAPACDataCounter++) {
				if(jsonObject[iAPACDataCounter].name =='APAC'){
					jsonObject.splice(iAPACDataCounter , 1);
					break;
				}
			}
			jsonObject.push(apacPopup);
		}
		$("#div_region_apac").show();
	}
	else{
		tempJsonObject.push(apacPopup);
	}
	return true;
}

function loadAPACPopupData(){
	$('label[for=productStatusAPAC]').html($('#apacTable tr:nth(1) td:nth(0)').text());
	$("#regionspopup #primarySellingUOMAPAC").val($('#apacTable tr:nth(1) td:nth(1)').text());
	$("#regionspopup #regionRowId").val($('#apacTable tr:nth(1) td:nth(2)').text());
}

function showAPACData(){
	$("select#addRegionOptions option[value*=5]").prop('disabled', true).css('background-color', '#CCC');
	$('#apacTable tr:nth(1) td:nth(0)').html(jsonData[iRegionCounter].productStatus);
	$('#apacTable tr:nth(1) td:nth(1)').html(jsonData[iRegionCounter].primarySellingUOM);
	$('#apacTable tr:nth(1) td:nth(2)').html(jsonData[iRegionCounter].regionRowId);
	jsonObject.push(jsonData[iRegionCounter]);
	$("#div_region_apac").show();
	disbaleProperties(stepNumber);
	if(editScreen == "saveNewForCrossFertilization"){
		if(jsonData[iRegionCounter].regionRowId){
			$('#apacTable ').find(".deleteRegion").hide();
		}
	}
}

function insertNalacRegionTableFunction(isTemp , isDone) {
	var regionName = "NALAC";
	nalacPopup = new Object();
	nalacPopup.name = regionName;
	nalacPopup.productStatus = $('label[for=productStatusNALAC]').html();
	nalacPopup.primarySellingUOM = $("#primarySellingUOMNALAC").val();
	nalacPopup.secondarySellingUOM = $("#secondarySellingUOMNALAC option:selected").val();
	nalacPopup.lowestShippableUOM = $("#lowestShippableUOMNALAC option:selected").val();
	nalacPopup.soldToNA = "Y";
	nalacPopup.regionRowId =  $("#regionRowId").val();
	if(editScreen === "saveNewSOSForNALAC" || editScreen === "newSOSForEMEA_APAC"){
		nalacPopup.flagForEditNALAC = true;
	}
	
	for(var jsonObjectCounter = 0; jsonObjectCounter < jsonObject.length; jsonObjectCounter++){
		if(jsonObject[jsonObjectCounter].name == 'GTC'){
			if(jsonObject[jsonObjectCounter].primarySellingUOM != nalacPopup.primarySellingUOM && (nalacPopup.primarySellingUOM != undefined || nalacPopup.primarySellingUOM != null)){
				$("#gtcTable tr:nth(1) td:nth(1)").html(nalacPopup.primarySellingUOM);
				jsonObject[jsonObjectCounter].primarySellingUOM = nalacPopup.primarySellingUOM;
			}
			
			if(jsonObject[jsonObjectCounter].secondarySellingUOM != nalacPopup.secondarySellingUOM && (nalacPopup.secondarySellingUOM != undefined || nalacPopup.secondarySellingUOM != null)){
				$("#gtcTable tr:nth(1) td:nth(2)").html(nalacPopup.secondarySellingUOM);
				jsonObject[jsonObjectCounter].secondarySellingUOM = nalacPopup.secondarySellingUOM;
			}
			
			if(jsonObject[jsonObjectCounter].lowestShippableUOM != nalacPopup.lowestShippableUOM && (nalacPopup.lowestShippableUOM != undefined || nalacPopup.lowestShippableUOM != null)){
				$("#gtcTable tr:nth(1) td:nth(3)").html(nalacPopup.lowestShippableUOM);
				jsonObject[jsonObjectCounter].lowestShippableUOM = nalacPopup.lowestShippableUOM;
			}
		}
	}
	
	nalacPopup.divisionAndTransferPriceCategory = $("#divisionAndTransferPriceCategoryNALAC").val();
	subRegion = new Array();
	orgsSubRegion = new Array();
	rowIdSubRegion = new Array();
	
	nalacPopup.subRegList = subRegionArr;
	
	var counter = 0;
	for(var i=0 ; i<regionsIndex ; i++){
		if($("tr#dynamicData" + i + " #nalacSubRegion_table"+i).html()!= undefined || $("tr#dynamicData" + i + " #nalacSubRegion_table"+i).html() != null){
			subRegion[counter] = $("tr#dynamicData" + i + " #nalacSubRegion_table"+i).html();
			orgsSubRegion[counter] = $("tr#dynamicData" + i + " #nalacOrgsSubRegion_table"+i).html();
			rowIdSubRegion[counter] = $("tr#dynamicData" + i + " #nalacrowIdSubRegion_table"+i).html();
			counter++;
		}
	}
	
	if(!isTemp){
		
		$("select#addRegionOptions option[value*=4]").prop('disabled', true).css('background-color', '#CCC');
		var tempProductJsonStr = JSON.stringify(nalacPopup);
		tempProductJsonStr = "{" + '"regionList"' +":"+ tempProductJsonStr + "}";
		tempProductJson = JSON.parse(tempProductJsonStr);
		var newValidationList = validationRuleList.filter(filterValidationListByScreenName,'nalac_region');
		var isValid = validate(newValidationList,tempProductJson);
		for(var iRegionErrorCounter =0 ; iRegionErrorCounter< regionErrorArray.length ; iRegionErrorCounter++){
			if(regionErrorArray[iRegionErrorCounter] == regionName){
				regionErrorArray.splice(iRegionErrorCounter , 1);
			}
		}
		regionErrorArray.push(regionName);
		if(!isValid){
			var errorMessage = '';
			$.each(errors, function( index, error) {
				errorMessage = errorMessage + bulletStyle + error.message + lineBreak;
				$("#"+error.fieldId).css("border-color","red");
				resetStyle.push(error.fieldId);
				$("[aria-labelledby='select2-"+error.fieldId+"-container']").css("border-color","red");
				resetAutocompleteArrayStyle.push("[aria-labelledby='select2-"+error.fieldId+"-container']");
			});
			userAction = confirm(errorMessage + lineBreak + 'Do you still want to proceed?');
			if(userAction == false){
				errors.length = 0;
				for(var iRegionErrorCounter =0 ; iRegionErrorCounter< regionErrorArray.length ; iRegionErrorCounter++){
					if(regionErrorArray[iRegionErrorCounter] == regionName){
						regionErrorArray.splice(iRegionErrorCounter , 1);
					}
				}
				return false;
			}
		}else{
			for(var iRegionErrorCounter =0 ; iRegionErrorCounter< regionErrorArray.length ; iRegionErrorCounter++){
				if(regionErrorArray[iRegionErrorCounter] == regionName){
					regionErrorArray.splice(iRegionErrorCounter , 1);
				}
			}
		}
		validationRuleList = validationRuleList.filter(filterValidationListByScreenName,'region');
		errors.length = 0;
		resetStyle.length = 0;

		$('#nalacTable tr:nth(1) td:nth(0)').html(nalacPopup.productStatus);
		$('#nalacTable tr:nth(1) td:nth(1)').html(nalacPopup.primarySellingUOM);
		$('#nalacTable tr:nth(1) td:nth(2)').html(nalacPopup.secondarySellingUOM);
		$('#nalacTable tr:nth(1) td:nth(3)').html(nalacPopup.lowestShippableUOM);
		$('#nalacTable tr:nth(1) td:nth(4)').html(nalacPopup.divisionAndTransferPriceCategory);
		$('#nalacTable tr:nth(1) td:nth(5)').html(nalacPopup.regionRowId);

		
		jQuery(".nalac-subregion tr:not(:first)").remove();
		selectedSubRegionsDropdownIds = subRegionArr;
		jQuery.each(selectedSubRegionsDropdownIds, function(index, value) {
			var trSubRegion = "<tr>";
			trSubRegion += "<td>" + value.subRegion + "</td>";
			trSubRegion += "<td>" + value.orgsInSubRegion + "</td>";
			trSubRegion += "<td style=\"display: none;\">"
					+ value.rowIdSubRegion + "</td>";
			trSubRegion += "</tr>";
			jQuery(".nalac-subregion").append(trSubRegion);
		});

		if (jsonObject.length <= 0) {
			jsonObject.push(nalacPopup);
		} else {
			for (var iNALACDataCounter = 0; iNALACDataCounter < jsonObject.length; iNALACDataCounter++) {
				if (jsonObject[iNALACDataCounter].name == 'NALAC') {
					jsonObject.splice(iNALACDataCounter, 1);
					break;
				}
			}
			jsonObject.push(nalacPopup);
		}
		
		$("#div_region_na_lac").show();
	}else{
		tempJsonObject.push(nalacPopup);
	}

	return true;
}

function loadNALACPopupData(){
	$('label[for=productStatusNALAC]').html($('#nalacTable tr:nth(1) td:nth(0)').text());
	
	if(isGBUChanged == false){
		$("#regionspopup #primarySellingUOMNALAC").val($('#nalacTable tr:nth(1) td:nth(1)').text());
	}
	if(isAPSPSPFlagUnchecked == false){
		$("#regionspopup #primarySellingUOMNALAC").val($('#nalacTable tr:nth(1) td:nth(1)').text());
	}else{
		if(gbu == 'SEXUAL WELLNESS'){
			$("#regionspopup #primarySellingUOMNALAC").val($('#nalacTable tr:nth(1) td:nth(1)').text());
		}else{
			$("#regionspopup #primarySellingUOMNALAC").val("CASE");
		}
	}
	
	$("#regionspopup #secondarySellingUOMNALAC").val($('#nalacTable tr:nth(1) td:nth(2)').text());
	$("#regionspopup #lowestShippableUOMNALAC").val($('#nalacTable tr:nth(1) td:nth(3)').text());
	$("#regionspopup #divisionAndTransferPriceCategoryNALAC").val($('#nalacTable tr:nth(1) td:nth(4)').text());
	$("#regionspopup #regionRowId").val($('#nalacTable tr:nth(1) td:nth(5)').text());
	$("#regionspopup #subRegionNALAC").val($('#nalacTable tr:nth(2) td:nth(0)').text());
	
	var tableRowCount = $(".nalac-subregion tr").length;
	for(var isubRegionCounter = 0; isubRegionCounter < tableRowCount-1 ; isubRegionCounter++ ){
		var nalacSubRegionRowId = $(".nalac-subregion tr:nth("+(isubRegionCounter+1)+") td:nth(2)").html();
			var displayValue = 
				"<tr id='dynamicData"+isubRegionCounter+"'>" +
					"<td id='nalacSubRegion_table"+isubRegionCounter+"'>"+ $(".nalac-subregion tr:nth("+(isubRegionCounter+1)+") td:nth(0)").html() + "</td>" +
					"<td id='nalacOrgsSubRegion_table"+isubRegionCounter+"'>" + $(".nalac-subregion tr:nth("+(isubRegionCounter+1)+") td:nth(1)").html() +"</td>"+
					"<td id='nalacrowIdSubRegion_table"+isubRegionCounter+"' style=\"display: none;\">" + $(".nalac-subregion tr:nth("+(isubRegionCounter+1)+") td:nth(2)").html() +"</td>"+
					"<td><input type='button' id='editRow' class='edit-btn-cls center-img-cls' name='editRow' value='edit' onclick=\'editInnerTableMeasuresAndSubRegion("+ isubRegionCounter +",\"nalacSubRegion_table\",\"nalacOrgsSubRegion_table\",\"nalacrowIdSubRegion_table\")\'></td>" +
					"<td><input type='button' id='deleteRow' class='delet-btn-cls center-img-cls' name='deleteRow' value='delete' onclick=\'deleteItem(\"subRegionTable\","+ isubRegionCounter +")\'></td>" +
				"</tr>";
		$("#displayRegionValues #subRegionTable").append(displayValue);
		$("select option[value*=" + $(".nalac-subregion tr:nth("+(isubRegionCounter+1)+") td:nth(0)").html().replace(/ +/g, "") + "]").prop('disabled', true);
		if(nalacSubRegionRowId != "" && editScreen === "saveNewForCrossFertilization"){
			$('#editRow').remove();
			$('#deleteRow').remove();
		}
	}
	regionsIndex = tableRowCount-1;
	
}

function showNALACData(){
	$("select#addRegionOptions option[value*=4]").prop('disabled', true).css('background-color', '#CCC');
	
	populateDataByFormula(jsonData[iRegionCounter]);
	
	$('#nalacTable tr:nth(1) td:nth(0)').html(jsonData[iRegionCounter].productStatus);
	$('#nalacTable tr:nth(1) td:nth(1)').html(jsonData[iRegionCounter].primarySellingUOM);
	$('#nalacTable tr:nth(1) td:nth(2)').html(jsonData[iRegionCounter].secondarySellingUOM);
	$('#nalacTable tr:nth(1) td:nth(3)').html(jsonData[iRegionCounter].lowestShippableUOM);
	$('#nalacTable tr:nth(1) td:nth(4)').html(jsonData[iRegionCounter].divisionAndTransferPriceCategory);
	$('#nalacTable tr:nth(1) td:nth(5)').html(jsonData[iRegionCounter].regionRowId);
	
	jQuery(".nalac-subregion tr:not(:first)").remove();	
	if(selectedSubRegionsDropdownIds.length == 0 && jsonData[iRegionCounter].subRegList != null){
		selectedSubRegionsDropdownIds = jsonData[iRegionCounter].subRegList;
	}
	if(selectedSubRegionsDropdownIds.length >0){
		jQuery.each(selectedSubRegionsDropdownIds, function(index, value){
			var trSubRegion = "<tr>";
			trSubRegion += "<td>" + value.subRegion + "</td>";
			trSubRegion += "<td>" + value.orgsInSubRegion + "</td>";
			trSubRegion += "<td style=\"display: none;\">" + value.rowIdSubRegion + "</td>";
			trSubRegion += "</tr>";
			jQuery(".nalac-subregion").append(trSubRegion);
		});
	}
	
	if(jsonData[iRegionCounter].subRegList != null){
		subRegionArr = selectedSubRegionsDropdownIds;
		//jsonData[iRegionCounter].subRegList = selectedSubRegionsDropdownIds;
	}
	
	jsonObject.push(jsonData[iRegionCounter]);
	$("#div_region_na_lac").show();
	disbaleProperties(stepNumber);
	if(editScreen == "saveNewForCrossFertilization"){
		if(jsonData[iRegionCounter].regionRowId){
			$('#nalacTable ').find(".deleteRegion").hide();
		}
	}
}


////////////////////////------------------REGION ends-----------------------------

//////////////////////////------------------SOS starts -----------------------------
// there are 4 methods for SOS. loadSoSPropuData(), addSOSPopup(sosRowRecord), insertSOSTableFunction(), showSOSData()

function addSOSPopup(sosRowRecord) {
	currrentClickedIndex = $("table tr").index($(sosRowRecord).closest("tr"));
	var myPos = [ $(window).width() / 10.5, $(window).width() / 45.6 ];
	var title = "Add Source of Supply";
	if(currrentClickedIndex > 0){
		title = "Edit Source of Supply";
	}
	$("#sosPopup").dialog({
		draggable : true,
		closeOnEscape : true,
		resizable : false,
		modal : true,
		dialogClass: 'propopup',
		cache : false,
		height : 'auto',
		width : '80%',
		title : title,
		close : function() {
			validationRuleList = validationRuleList.filter(filterValidationListByScreenName,'sos');
			$(this).dialog('close').empty();
		},
		position : myPos,
		buttons : {
			'Cancel' : function() {
				validationRuleList = validationRuleList.filter(filterValidationListByScreenName,'sos');
				$(this).dialog('close');
			},
			'Done' : function() {
				var isValid;
				isValid = insertSOSTableFunction(false);
				if(isValid){
					$(this).dialog('close').empty();
				}
			}
		}

	}).load('addEditSOSPopup');
}

function insertSOSTableFunction(isTemp) {
	var sosPopup = new Object();
	sosPopup.sourceCode = $("#sosPopup #sourceCode").find(":selected").val();
	sosPopup.sourceCountry = $("#sosPopup #sourceCountry").val();
	sosPopup.sourceDescription = $("#sosPopup #sourceDescription").val();
	sosPopup.primaryOriginFlag = $("#sosPopup #primaryOriginFlag").prop('checked');
	sosPopup.procureViaGTC = $("#sosPopup #procureViaGTC").prop('checked');
	sosPopup.active = $("#sosPopup #active").prop('checked');
	sosPopup.ansellPlant = $("#sosPopup #ansellPlant").prop('checked');
	sosPopup.establishmentFacilityId = $("#sosPopup #establishmentFacilityID").val();
	sosPopup.medicalDeviceListing = $("#sosPopup #medicalDeviceListing").val();
	sosPopup.kCode = $("#sosPopup #code").val();
	sosPopup.sosRowId = $("#sosPopup #sosRowId").val();
	
	
	if (sosPopup.primaryOriginFlag) {
		sosPopup.primaryOriginFlag = "Y";
	} else {
		sosPopup.primaryOriginFlag = "N";
	}

	if (sosPopup.procureViaGTC) {
		sosPopup.procureViaGTC = "Y";
	} else {
		sosPopup.procureViaGTC = "N";
	}

	if (sosPopup.active) {
		sosPopup.active = "Y";
	} else {
		sosPopup.active = "N";
	}

	if (sosPopup.ansellPlant) {
		sosPopup.ansellPlant = "Y";
	} else {
		sosPopup.ansellPlant = "N";
	}
	if(editScreen === "saveNewSOSForNALAC"){
		sosPopup.flagForEditNALAC = true;;
	}
	if(!isTemp){
		var tempProductJsonStr = JSON.stringify(sosPopup);
		tempProductJsonStr = "{" + '"sosList"' +":"+ tempProductJsonStr + "}";
		tempProductJson = JSON.parse(tempProductJsonStr);
		var newValidationList = validationRuleList.filter(filterValidationListByScreenName,'sos_add_edit');
		var isValid = validate(newValidationList,tempProductJson);
		
		if(!isValid){
			var errorMessage = '';
			$.each(errors, function( index, error) {
				errorMessage = errorMessage + bulletStyle + error.message + lineBreak;
				$("#"+error.fieldId).css("border-color","red");
				resetStyle.push(error.fieldId);
				$("[aria-labelledby='select2-"+error.fieldId+"-container']").css("border-color","red");
				resetAutocompleteArrayStyle.push("[aria-labelledby='select2-"+error.fieldId+"-container']");
			});
			userAction = confirm(errorMessage + 'Do you still want to proceed?');
			if(userAction == false){
				errors.length = 0;
				return false;
			}else if(currrentClickedIndex <0 ){
				sosErrorArray.push(true);
			}else{
				sosErrorArray[currrentClickedIndex] = true;
			}
		}else if(currrentClickedIndex < 0){
			sosErrorArray.push(false);
		}else{
			if(currrentClickedIndex >= 1){
				sosErrorArray[currrentClickedIndex - 1] = false;
			}
		}
		validationRuleList = validationRuleList.filter(filterValidationListByScreenName,'sos');
		errors.length = 0;
		resetStyle.length = 0;

		if(currrentClickedIndex >= 0){
			$('#sosTable tr:nth('+currrentClickedIndex+') td:nth(0)').html(sosPopup.sourceCode);
			$('#sosTable tr:nth('+currrentClickedIndex+') td:nth(1)').html(sosPopup.sourceDescription);
			$('#sosTable tr:nth('+currrentClickedIndex+') td:nth(2)').html(sosPopup.sourceCountry);
			$('#sosTable tr:nth('+currrentClickedIndex+') td:nth(3)').html(sosPopup.primaryOriginFlag);
			$('#sosTable tr:nth('+currrentClickedIndex+') td:nth(4)').html(sosPopup.procureViaGTC);
			$('#sosTable tr:nth('+currrentClickedIndex+') td:nth(5)').html(sosPopup.active);
			$('#sosTable tr:nth('+currrentClickedIndex+') td:nth(6)').html(sosPopup.ansellPlant);
			$('#sosTable tr:nth('+currrentClickedIndex+') td:nth(7)').html(sosPopup.establishmentFacilityId);
			$('#sosTable tr:nth('+currrentClickedIndex+') td:nth(8)').html(sosPopup.medicalDeviceListing);
			$('#sosTable tr:nth('+currrentClickedIndex+') td:nth(9)').html(sosPopup.kCode);
			$('#sosTable tr:nth('+currrentClickedIndex+') td:nth(10)').html(sosPopup.sosRowId);

			jsonObject[currrentClickedIndex-1] = sosPopup;
			currrentClickedIndex = -1;
			return true;
		}

		var d = JSON.stringify(sosPopup);
		
		$.ajax({
			type : "POST",
			url : "getTemplate",
			data : {
				"v" : "sos",
				"d" : d
			},
			async : true,
			success : function(data) {
				$('#sosTable tr:last').after(data);
			}
		});
		jsonObject.push(sosPopup);
	}
	else{
		tempJsonObject.push(sosPopup);
	}
	
	return true;
}

function showSOSData(a_isPreviewPage){
	var l_jsonDataSOS = wizardObject[step_04].sosList;
	if(l_jsonDataSOS.length <0){

		return;
	}
	fetchLookUpVal(null,'ORIGIN',null,null,'sourceCode');
	var d = JSON.stringify(l_jsonDataSOS[0]);
	
	var sosRow = null;
	$.ajax({
		type : "POST",
		url  : "getTemplate",
		data : {
		         "v"  : "sos",
		         "d"  : d
	    },
		async : true,
		success : function(data) {
			sosRow = data;
			var sosListLength = l_jsonDataSOS.length;
			for(var iSOSCounter = 0 ; iSOSCounter < sosListLength; iSOSCounter++){
				jsonObject.push(l_jsonDataSOS[iSOSCounter]);
				$('#sosTable tr:last').after(sosRow);
				
				
				if(iSOSCounter == 0){
					if((l_jsonDataSOS[iSOSCounter].sosRowId != null || l_jsonDataSOS[iSOSCounter].sosRowId != "")&& editScreen === "saveNewSOSForNALAC") {
						$(".delet-btn-cls").remove();
					}
					continue;
				}
				$('#sosTable tr:last td:nth(0)').html(l_jsonDataSOS[iSOSCounter].sourceCode);
				$('#sosTable tr:last td:nth(1)').html(l_jsonDataSOS[iSOSCounter].sourceDescription);
				$('#sosTable tr:last td:nth(2)').html(l_jsonDataSOS[iSOSCounter].sourceCountry);
				$('#sosTable tr:last td:nth(3)').html(l_jsonDataSOS[iSOSCounter].primaryOriginFlag);
				$('#sosTable tr:last td:nth(4)').html(l_jsonDataSOS[iSOSCounter].procureViaGTC);
				$('#sosTable tr:last td:nth(5)').html(l_jsonDataSOS[iSOSCounter].active);
				$('#sosTable tr:last td:nth(6)').html(l_jsonDataSOS[iSOSCounter].ansellPlant);
				$('#sosTable tr:last td:nth(7)').html(l_jsonDataSOS[iSOSCounter].establishmentFacilityId);
				$('#sosTable tr:last td:nth(8)').html(l_jsonDataSOS[iSOSCounter].medicalDeviceListing);
				$('#sosTable tr:last td:nth(9)').html(l_jsonDataSOS[iSOSCounter].kCode);
				$('#sosTable tr:last td:nth(10)').html(l_jsonDataSOS[iSOSCounter].sosRowId);
				
				if(l_jsonDataSOS[iSOSCounter].sosRowId != "" && editScreen === "saveNewSOSForNALAC") {
					$(".delet-btn-cls").remove();
				}
				
				
			}//end of for loop
			if(a_isPreviewPage){
				$(".sosBtns").remove();
				$(".sosdelBtn").hide();
			}
			disbaleProperties(stepNumber);
			updateProperties(stepNumber);
	 	}
 	}); 
}

function loadSoSPopData(){
	if(currrentClickedIndex < 0){
		return;
	}
	$("#sosPopup #sourceCode").val($('#sosTable tr:nth('+currrentClickedIndex+') td:nth(0)').text());
	$("#sosPopup #sourceDescription").val($('#sosTable tr:nth('+currrentClickedIndex+') td:nth(1)').text());
	$("#sosPopup #sourceCountry").val($('#sosTable tr:nth('+currrentClickedIndex+') td:nth(2)').text());
	$("#sosPopup #primaryOriginFlag").attr("checked", ($('#sosTable tr:nth('+currrentClickedIndex+') td:nth(3)').text() == 'Y'));
	$("#sosPopup #procureViaGTC").attr("checked", ($('#sosTable tr:nth('+currrentClickedIndex+') td:nth(4)').text() == 'Y'));
	$("#sosPopup #active").attr("checked", ($('#sosTable tr:nth('+currrentClickedIndex+') td:nth(5)').text() == 'Y'));
	$("#sosPopup #ansellPlant").attr("checked",($('#sosTable tr:nth('+currrentClickedIndex+') td:nth(6)').text() == 'Y'));
	$("#sosPopup #establishmentFacilityID").val($('#sosTable tr:nth('+currrentClickedIndex+') td:nth(7)').text());
	$("#sosPopup #medicalDeviceListing").val($('#sosTable tr:nth('+currrentClickedIndex+') td:nth(8)').text());
	$("#sosPopup #code").val($('#sosTable tr:nth('+currrentClickedIndex+') td:nth(9)').text());
	$("#sosPopup #sosRowId").val($('#sosTable tr:nth('+currrentClickedIndex+') td:nth(10)').text());
	
}

//////////////////////////------------------SOS ends-------------------------------

/////////////////////////-------------------PRODUCT starts-------------------------
// there are 11 methods for PRODUCT. function addProductPopup(productRowRecord) , insertProductTableFunction() , showProductData(), loadProductPopupData() , 
//measuresSelection() ,showMeasuresData() , showPackagingConfigurationMessage(),  editInnerTableMeasuresAndSubRegion(position,nameId,valueId) ,
//hideNextThreeRow(productRowRecord), hideWholeTable() , clearProductEditorFields()

function expandComments(){
	jQuery("#productTable td").find(".comments label:nth(1)").css("height", '');
}

function collapseComments(){
	jQuery("#productTable td").find(".comments label:nth(1)").css("height", '18px');
}

function addProductPopup(productRowRecord , isDuplicate) {
	currrentClickedIndex = $("table tr").index($(productRowRecord).closest("tr"));
	var title = "Add Product";
	if(currrentClickedIndex > 0){
		selectedMeasuresDropdownIds = new Array();
		measuresValue = new Array();
		var internalProductId = $('#productTable tr:nth('+currrentClickedIndex+') td:nth(1)').text();
		title = "Edit Product" + ((internalProductId.length > 0) ? (" : " + internalProductId) : "");
		if(isDuplicate){
			emptyFields = true;
			title = "Add Product";
		}
	}
	
	messageMeasuresName = new Array();
	messageMeasuresValue = new Array();
	dynamicTableId = 0;
	var myPos = [ $(window).width() / 10.5, $(window).width() / 45.6 ];
	$("#productPopup")
			.dialog(
					{
						draggable : true,
						closeOnEscape : true,
						resizable : false,
						modal : true,
						cache : false,
						height : 'auto',
						dialogClass: 'propopup',
						width : '80%',
						title : title ,
						close : function() {
							validationRuleList = validationRuleList.filter(filterValidationListByScreenName,'product');
							$(this).dialog('close').empty();
						},
						position : myPos,
						buttons : {
							'Cancel' : function() {
								validationRuleList = validationRuleList.filter(filterValidationListByScreenName,'product');
								$(this).dialog('close');
								
							},
							'Done' : function() {
								showPackagingConfigurationMessage();
								isValid = insertProductTableFunction(isDuplicate, false);
								if(isValid){
									validationRuleList = validationRuleList.filter(filterValidationListByScreenName,'product');
									$(this).dialog('close').empty();
								}
							},
							'Add another' : {
								dialogClass: 'myStyle',
								id: 'add-another-btns',
								text : 'Add another',
								click : function() {
									isValid = insertProductTableFunction(isDuplicate, false);
									if(isValid){
										clearProductEditorFields();
									}
								}
							}
						}
					}).load('addEditProductPopup' , {editScreen:editScreen});
}

function insertProductTableFunction(isDuplicate, isTemp) {
	var productTable = document.getElementById("productTable");
	productTable.border = 1;
	productPopup = new Object();
	var productOverrideChckBox = $('#myToggleButton').prop('checked');
	
	if(productOverrideChckBox){
		productPopup.productID = $("#productPopup #productOverride").val();
	}else{
		productPopup.productID = $("#productPopup #productID").val();
	}
	
	eProductOverrideChckBox = $('#eProductIdToggleButton').prop('checked');
	
	if(eProductOverrideChckBox){
		productPopup.externalProductID = $("#productPopup #eProductIdOverride").val();
	}else{
		productPopup.externalProductID = $("#productPopup #eProductId").val();
	}
	productPopup.productOverrideChckBoxState = productOverrideChckBox;
	productPopup.eProductOverrideChckBoxState = eProductOverrideChckBox;
	productPopup.internalProductID = $("#productPopup #iProductId").val();
	productPopup.oracleProductID = $("#productPopup #oracleProductID").val();
	productPopup.manufacturingProductID = $("#productPopup #manufacturingProductID").val();
	productPopup.gtinEANOuter = $("#productPopup #gtinEanOuter").val();
	productPopup.gtinEANInner = $("#productPopup #gtinEanInner").val();
	productPopup.gtinEANUnit = $("#productPopup #gtinEanUnit").val();
	productPopup.size = $("#productPopup #size").find(":selected").val();
	productPopup.workflowStatus = $( "#workflowStatus").text();
	productPopup.comments = $("#productPopup #comments").val();
	productPopup.grossWeight = $("#productPopup #grossWeight").val();
	productPopup.netWeight = $("#productPopup #netWeight").val();
	productPopup.caseCarton = $("#productPopup #caseCarton").val();
	productPopup.bag = $("#productPopup #bag").val();
	productPopup.displayDispenser = $("#productPopup #displayDispenser").val();
	productPopup.length = $("#productPopup #length").val();
	lengthInM = productPopup.length/ 100;
	productPopup.width = $("#productPopup #width").val();
	widthInM = productPopup.width/ 100;
	productPopup.height = $("#productPopup #height").val();
	heightInM = productPopup.height/ 100;
	var volumeInMeterCube = (lengthInM * widthInM * heightInM);
	var fixedVolume= parseFloat(volumeInMeterCube).toFixed(5);
	if(fixedVolume.indexOf("e+")!== -1){
		fixedVolume = parseFloat(fixedVolume);
		var volumeWithoutExponent = fixedVolume.noExponents();
		productPopup.volume = volumeWithoutExponent;
	}else{
		productPopup.volume = fixedVolume;
	}
	productPopup.gross = "";
	productPopup.pack = "";
	productPopup.box = "";
	productPopup.retailPack = "";
	productPopup.bundle = "";
	productPopup.dozen = "";
	productPopup.kit = "";
	productPopup.packagingConf = $("#productPopup #measuresInformation").text();
	productPopup.variant = $("#productPopup #variant").val();
	productPopup.productDescSuffix = $("#productPopup #productDescSuffix").val();
	productPopup.packCount = $("#productPopup #packCount").val();
	productPopup.sizeCode = $("#productPopup #sizeCode").val();
	productPopup.rowIdBoProduct = $("#productPopup #rowIdBoProduct").val();
	productPopup.rowIdBoProductPkg = $("#productPopup #rowIdBoProductPkg").val();
	productPopup.rowIdBoProductPkgUom = $("#productPopup #rowIdBoProductPkgUom").val();
	if(editScreen != 'saveUpdate'){
		productPopup.eanOuter	= $("#productPopup #gtinEanOuter").val();
		productPopup.eanInner	= $("#productPopup #gtinEanInner").val();
		productPopup.eanUnit	= $("#productPopup #gtinEanUnit").val();
	}else{
		productPopup.eanOuter = $("#productPopup #eANOuter").val();
		productPopup.eanInner =	$("#productPopup #eANInner").val();
		productPopup.eanUnit = $("#productPopup #eANUnit").val();
	}
		
	if(editScreen === "saveNewSOSForNALAC"){
		productPopup.flagForEditNALAC = true;;
	}
	
	for(iMeasuresCounter = 0; iMeasuresCounter < messageMeasuresName.length ; iMeasuresCounter++){
		if(messageMeasuresName[iMeasuresCounter] == "Gross"){
			productPopup.gross = messageMeasuresValue[iMeasuresCounter];
		}
		if(messageMeasuresName[iMeasuresCounter] == "Pack"){
			productPopup.pack = messageMeasuresValue[iMeasuresCounter];
		}
		if(messageMeasuresName[iMeasuresCounter] == "Box"){
			productPopup.box = messageMeasuresValue[iMeasuresCounter];
		}
		if(messageMeasuresName[iMeasuresCounter] == "Retail Pack"){
			productPopup.retailPack = messageMeasuresValue[iMeasuresCounter];
		}
		if(messageMeasuresName[iMeasuresCounter] == "Bundle"){
			productPopup.bundle = messageMeasuresValue[iMeasuresCounter];
		}
		if(messageMeasuresName[iMeasuresCounter] == "Dozen"){
			productPopup.dozen = messageMeasuresValue[iMeasuresCounter];
		}
		if(messageMeasuresName[iMeasuresCounter] == "Kit"){
			productPopup.kit = messageMeasuresValue[iMeasuresCounter];
		}
	}
	if(!isTemp){
		var tempProductJsonStr = JSON.stringify(productPopup);
		tempProductJsonStr = "{" + '"productList"' +":"+ tempProductJsonStr + "}";
		tempProductJson = JSON.parse(tempProductJsonStr);
		var newValidationList = validationRuleList.filter(filterValidationListByScreenName,'product_add_edit');
		var isValid = validate(newValidationList,tempProductJson);
		var validation = isNumericFields();
		
		if(!isValid || validation.length > 0){
			var errorMessage = '';
			for(var validationCounter =0; validationCounter < validation.length; validationCounter++){
				if(!validation[validationCounter][0]){
					$("#"+validation[validationCounter][1]).css("border-color","red");

					if(validation[validationCounter][3] === "longDecimalValueError"){
						errorMessage =  errorMessage + longDecimalValueError + validation[validationCounter][2] + "\n";
					}
					if(validation[validationCounter][3] === "noSpecialCharchters"){
						errorMessage =  bulletStyle + errorMessage + noSpecialCharchters + validation[validationCounter][2] + "\n";
					}
					/*else if(validation[validationCounter][3] === "factorizationErrorMessage"){
						errorMessage =  errorMessage + factorizationErrorMessage + " " + validation[validationCounter][2] + "\n";
					}else if(validation[validationCounter][3] ==="longDecimalValueError"){
						errorMessage =  errorMessage + longDecimalValueError + " "+validation[validationCounter][2] + "\n";
					}*/
				}
			}
			$.each(errors, function( index, error) {
				//if(gbu != "SEXUAL WELLNESS" || errors[index].fieldId != "eProductId"){
					errorMessage = errorMessage + bulletStyle + error.message + lineBreak;
					$("#"+error.fieldId).css("border-color","red");
					resetStyle.push(error.fieldId);
					$("[aria-labelledby='select2-"+error.fieldId+"-container']").css("border-color","red");
					resetAutocompleteArrayStyle.push("[aria-labelledby='select2-"+error.fieldId+"-container']");
				//}
			});
			
			if(errorMessage != ''){
				userAction = confirm(errorMessage + lineBreak + 'Do you still want to proceed?');
				if(userAction == false){
					errors.length = 0;
					return false;
				}else if(currrentClickedIndex < 0){
					productErrorArray.push(true);
				}else{
					if(currrentClickedIndex == 1){
						productErrorArray[currrentClickedIndex - 1] = true;
					}else{
						productErrorArray[Math.floor(currrentClickedIndex/5)] = true;
					}
				}
			}
		}else{
			if(currrentClickedIndex <0){
				productErrorArray.push(false);
			}else{
				if(currrentClickedIndex == 1){
					productErrorArray[currrentClickedIndex - 1] = false;
				}else{
					productErrorArray[Math.floor(currrentClickedIndex/5)] = false;
				}
			}
		}
		//validationRuleList = validationRuleList.filter(filterValidationListByScreenName,'product');
		errors.length = 0;
		resetStyle.length = 0;
		if(isDuplicate != true){
			if(currrentClickedIndex >= 0){
				$('#productTable tr:nth('+currrentClickedIndex+') td:nth(1)').html(productPopup.internalProductID);
				$('#productTable tr:nth('+currrentClickedIndex+') td:nth(2)').html(productPopup.oracleProductID);
				$('#productTable tr:nth('+currrentClickedIndex+') td:nth(3)').html(productPopup.externalProductID);
				$('#productTable tr:nth('+currrentClickedIndex+') td:nth(4)').html(productPopup.productID);
				$('#productTable tr:nth('+currrentClickedIndex+') td:nth(5)').html(productPopup.size);
				$('#productTable tr:nth('+currrentClickedIndex+') td:nth(6)').html(productPopup.variant);
				$('#productTable tr:nth('+currrentClickedIndex+') td:nth(7)').html(productPopup.productDescSuffix);
				$('#productTable tr:nth('+currrentClickedIndex+') td:nth(8)').html(productPopup.gtinEANOuter);
				$('#productTable tr:nth('+currrentClickedIndex+') td:nth(9)').html(productPopup.gtinEANInner);
				$('#productTable tr:nth('+currrentClickedIndex+') td:nth(10)').html(productPopup.gtinEANUnit);
				$('#productTable tr:nth('+currrentClickedIndex+') td:nth(11)').html(productPopup.eanOuter);
				$('#productTable tr:nth('+currrentClickedIndex+') td:nth(12)').html(productPopup.eanInner);
				$('#productTable tr:nth('+currrentClickedIndex+') td:nth(13)').html(productPopup.eanUnit);
				$('#productTable tr:nth('+currrentClickedIndex+') td:nth(14)').html(productPopup.workflowStatus);
				$('#productTable tr:nth('+currrentClickedIndex+') td:nth(15)').html(productPopup.productOverrideChckBoxState);
				$('#productTable tr:nth('+currrentClickedIndex+') td:nth(16)').html(productPopup.eProductOverrideChckBoxState);
				$('#productTable tr:nth('+currrentClickedIndex+') td:nth(17)').html(productPopup.rowIdBoProduct);
				$('#productTable tr:nth('+currrentClickedIndex+') td:nth(18)').html(productPopup.rowIdBoProductPkg);
				$('#productTable tr:nth('+currrentClickedIndex+') td:nth(19)').html(productPopup.rowIdBoProductPkgUom);
				
				$('#productTable tr:nth('+(currrentClickedIndex+3)+') td:nth(0)').html(productPopup.grossWeight);
				$('#productTable tr:nth('+(currrentClickedIndex+3)+') td:nth(1)').html(productPopup.netWeight);
				$('#productTable tr:nth('+(currrentClickedIndex+3)+') td:nth(2)').html(productPopup.length);
				$('#productTable tr:nth('+(currrentClickedIndex+3)+') td:nth(3)').html(productPopup.width);
				$('#productTable tr:nth('+(currrentClickedIndex+3)+') td:nth(4)').html(productPopup.height);
				$('#productTable tr:nth('+(currrentClickedIndex+3)+') td:nth(5)').html(productPopup.volume);
				$('#productTable tr:nth('+(currrentClickedIndex+3)+') td:nth(6)').html(productPopup.caseCarton);
				$('#productTable tr:nth('+(currrentClickedIndex+3)+') td:nth(7)').html(productPopup.gross);
				$('#productTable tr:nth('+(currrentClickedIndex+3)+') td:nth(8)').html(productPopup.dozen);
				$('#productTable tr:nth('+(currrentClickedIndex+3)+') td:nth(9)').html(productPopup.bag);
				$('#productTable tr:nth('+(currrentClickedIndex+3)+') td:nth(10)').html(productPopup.box);
				$('#productTable tr:nth('+(currrentClickedIndex+3)+') td:nth(11)').html(productPopup.displayDispenser);
				$('#productTable tr:nth('+(currrentClickedIndex+3)+') td:nth(12)').html(productPopup.pack);
				$('#productTable tr:nth('+(currrentClickedIndex+3)+') td:nth(13)').html(productPopup.retailPack);
				$('#productTable tr:nth('+(currrentClickedIndex+3)+') td:nth(14)').html(productPopup.bundle);
				$('#productTable tr:nth('+(currrentClickedIndex+3)+') td:nth(15)').html(productPopup.kit);
				$('#productTable tr:nth('+(currrentClickedIndex+3)+') td:nth(16)').html(productPopup.packCount);
				$('#productTable tr:nth('+(currrentClickedIndex+4)+') td:nth(1)').html(productPopup.packagingConf);
				$('#productTable tr:nth('+(currrentClickedIndex+4)+') td:nth(2)').find(".comments label:nth(1)").html(productPopup.comments);
				
				/*if(gbu == "SEXUAL WELLNESS"){
					$('#productTable tr:nth('+(currrentClickedIndex+3)+') td:nth(16)').html(productPopup.packCount);
					$('#productTable tr:nth('+currrentClickedIndex+') td:nth(6)').html(productPopup.variant);
					$('#productTable tr:nth('+currrentClickedIndex+') td:nth(7)').html(productPopup.productDescSuffix);
				}*/
				
				showMeasuresData();
				if(currrentClickedIndex == 1){
					jsonObject[currrentClickedIndex-1] = productPopup;
				}else{
					var x = (currrentClickedIndex/5);
					jsonObject[Math.floor(x)] = productPopup;
				}
				currrentClickedIndex = -1;
				return true;
			}
		}else{
			productPopup.internalProductID = '';
			productPopup.oracleProductID = '';
			productPopup.rowIdBoProduct = '';
			productPopup.rowIdBoProductPkg = '';
			productPopup.rowIdBoProductPkgUom = '';
		}
		var d = JSON.stringify(productPopup);
		$.ajax({
			type : "POST",
			url : "getTemplate",
			data : {
				"v" : "product",
				"d" : d
			},
			async : true,
			success : function(data) {
				$('#productTable tr:last').after(data);
				for(var iProductPackCounter=0; iProductPackCounter < jsonObject.length; iProductPackCounter++){
					var packCount = jsonObject[iProductPackCounter].packCount;
					var variant =  jsonObject[iProductPackCounter].variant;
					var productDescSuffix = jsonObject[iProductPackCounter].productDescSuffix;
					if(gbu == "SEXUAL WELLNESS"){
						$('#productTable tr:nth('+((iProductPackCounter*5) + 3)+') th:nth(16)').show();//For packCount
						$('#productTable tr:nth('+((iProductPackCounter*5) + 4)+') td:nth(16)').show();//For packCount
						
						$('#productTable tr:nth('+iProductPackCounter+') th:nth(5)').show();//For variant
						$('#productTable tr:nth('+((iProductPackCounter*5) + 1)+') td:nth(6)').show();//For variant
						
						$('#productTable tr:nth('+iProductPackCounter+') th:nth(6)').show();//For productDescriptionSuffix
						$('#productTable tr:nth('+((iProductPackCounter*5) + 1)+') td:nth(7)').show();//For productDescriptionSuffix
					}else{
						$('#productTable tr:nth('+((iProductPackCounter*5) + 3)+') th:nth(16)').hide();
						$('#productTable tr:nth('+((iProductPackCounter*5) + 4)+') td:nth(16)').hide();
						
						$('#productTable tr:nth('+iProductPackCounter*5+') th:nth(5)').hide();//For variant
						$('#productTable tr:nth('+((iProductPackCounter*5) + 1)+') td:nth(6)').hide();//For variant
						
						$('#productTable tr:nth('+iProductPackCounter*5+') th:nth(6)').hide();//For productDescriptionSuffix
						$('#productTable tr:nth('+((iProductPackCounter*5) + 1)+') td:nth(7)').hide();//For productDescriptionSuffix
					}
					
					if(editScreen === "saveUpdate")	{
						$('#productTable tr:nth('+iProductPackCounter+') th:nth(10)').show();
						$('#productTable tr:nth('+((iProductPackCounter*5) + 1)+') td:nth(11)').show();
						
						$('#productTable tr:nth('+iProductPackCounter+') th:nth(11)').show();
						$('#productTable tr:nth('+((iProductPackCounter*5) + 1)+') td:nth(12)').show();
						
						$('#productTable tr:nth('+iProductPackCounter+') th:nth(12)').show();
						$('#productTable tr:nth('+((iProductPackCounter*5) + 1)+') td:nth(13)').show();
					}else{
						$('#productTable tr:nth('+iProductPackCounter*5+') th:nth(10)').hide();
						$('#productTable tr:nth('+((iProductPackCounter*5) + 1)+') td:nth(11)').hide();
						
						$('#productTable tr:nth('+iProductPackCounter*5+') th:nth(11)').hide();
						$('#productTable tr:nth('+((iProductPackCounter*5) + 1)+') td:nth(12)').hide();
						
						$('#productTable tr:nth('+iProductPackCounter*5+') th:nth(12)').hide();
						$('#productTable tr:nth('+((iProductPackCounter*5) + 1)+') td:nth(13)').hide();
					}
				}
			}
		});
		jsonObject.push(productPopup);
	}
	else{
		tempJsonObject.push(productPopup);
	}
	return true;
}

function showProductData(a_isPreviewPage){
	var l_jsonDataProduct = wizardObject[step_03].productList;
	if(l_jsonDataProduct.length < 0){
		return;
	}
	
	var d = JSON.stringify(l_jsonDataProduct[0]);
	var productRow = null;
	$.ajax({
		type : "POST",
		url  : "getTemplate",
		data : {
		         "v"  : "product",
		         "d"  : d
	    },
		async : true,
		success : function(data) {
			productRow = data;
			var productListLength = l_jsonDataProduct.length;
			for(var iProductCounter = 0 ; iProductCounter < productListLength; iProductCounter++){
				jsonObject.push(l_jsonDataProduct[iProductCounter]);
				populateDataByFormula(l_jsonDataProduct[iProductCounter]);
				$('#productTable tr:last').after(productRow);
				
				/*if(editScreen === 'saveNewSOSForNALAC' && l_jsonDataProduct[iProductCounter].flagForEditNALAC == null){
					//$('#productTable tr:last').find(".dropdown").hide();
					$('#productTable tbody tr:eq(1) td:last').hide();
				}*/
				
				var packCount = l_jsonDataProduct[iProductCounter].packCount;
				if(gbu == "SEXUAL WELLNESS"){
					$('#productTable tr:nth('+((iProductCounter*5) + 3)+') th:nth(16)').show();
					$('#productTable tr:nth('+((iProductCounter*5) + 4)+') td:nth(16)').show();
						
					$('#productTable tr:nth('+iProductCounter+') th:nth(5)').show();//For variant
					$('#productTable tr:nth('+((iProductCounter*5) + 1)+') td:nth(6)').show();//For variant
						
					$('#productTable tr:nth('+iProductCounter+') th:nth(6)').show();//For productDescriptionSuffix
					$('#productTable tr:nth('+((iProductCounter*5) + 1)+') td:nth(7)').show();//For productDescriptionSuffix
				}else{
					$('#productTable tr:nth('+((iProductCounter*5) + 3)+') th:nth(16)').hide();
					$('#productTable tr:nth('+((iProductCounter*5) + 4)+') td:nth(16)').hide();
						
					$('#productTable tr:nth('+iProductCounter*5+') th:nth(5)').hide();//For variant
					$('#productTable tr:nth('+((iProductCounter*5) + 1)+') td:nth(6)').hide();//For variant
						
					$('#productTable tr:nth('+iProductCounter*5+') th:nth(6)').hide();//For productDescriptionSuffix
					$('#productTable tr:nth('+((iProductCounter*5) + 1)+') td:nth(7)').hide();//For productDescriptionSuffix
				}
					
				if(editScreen === "saveUpdate" || a_isPreviewPage == true)	{
					$('#productTable tr:nth('+iProductCounter+') th:nth(10)').show();
					$('#productTable tr:nth('+((iProductCounter*5) + 1)+') td:nth(11)').show();
					
					$('#productTable tr:nth('+iProductCounter+') th:nth(11)').show();
					$('#productTable tr:nth('+((iProductCounter*5) + 1)+') td:nth(12)').show();
					
					$('#productTable tr:nth('+iProductCounter+') th:nth(12)').show();
					$('#productTable tr:nth('+((iProductCounter*5) + 1)+') td:nth(13)').show();
				}else{
					$('#productTable tr:nth('+iProductCounter*5+') th:nth(10)').hide();
					$('#productTable tr:nth('+((iProductCounter*5) + 1)+') td:nth(11)').hide();
					
					$('#productTable tr:nth('+iProductCounter*5+') th:nth(11)').hide();
					$('#productTable tr:nth('+((iProductCounter*5) + 1)+') td:nth(12)').hide();
					
					$('#productTable tr:nth('+iProductCounter*5+') th:nth(12)').hide();
					$('#productTable tr:nth('+((iProductCounter*5) + 1)+') td:nth(13)').hide();
				}
				
				if(editScreen === "saveUpdate"){
					$('#gtinOuter').text('GTINOuter');
					$('#gtinInner').text('GTINInner');
					$('#gtinUnit').text('GTINUnit');
				}
				
				if(iProductCounter == 0){
					$('#productTable tr:nth('+((iProductCounter*5) + 1)+') td:nth(4)').html(l_jsonDataProduct[iProductCounter].productID);
					$('#productTable tr:nth('+((iProductCounter*5) + 1)+') td:nth(3)').html(l_jsonDataProduct[iProductCounter].externalProductID);
					continue;
					
				}
				
				$('#productTable tr:nth('+((iProductCounter*5) + 1)+') td:nth(1)').html(l_jsonDataProduct[iProductCounter].internalProductID);
				$('#productTable tr:nth('+((iProductCounter*5) + 1)+') td:nth(2)').html(l_jsonDataProduct[iProductCounter].oracleProductID);
				$('#productTable tr:nth('+((iProductCounter*5) + 1)+') td:nth(3)').html(l_jsonDataProduct[iProductCounter].externalProductID);
				$('#productTable tr:nth('+((iProductCounter*5) + 1)+') td:nth(4)').html(l_jsonDataProduct[iProductCounter].productID);
				$('#productTable tr:nth('+((iProductCounter*5) + 1)+') td:nth(5)').html(l_jsonDataProduct[iProductCounter].size);
				/*$('#productTable tr:nth('+((iProductCounter*5) + 1)+') td:nth(6)').html(l_jsonDataProduct[iProductCounter].variant);
				$('#productTable tr:nth('+((iProductCounter*5) + 1)+') td:nth(7)').html(l_jsonDataProduct[iProductCounter].productDescSuffix);*/
				$('#productTable tr:nth('+((iProductCounter*5) + 1)+') td:nth(8)').html(l_jsonDataProduct[iProductCounter].gtinEANOuter);
				$('#productTable tr:nth('+((iProductCounter*5) + 1)+') td:nth(9)').html(l_jsonDataProduct[iProductCounter].gtinEANInner);
				$('#productTable tr:nth('+((iProductCounter*5) + 1)+') td:nth(10)').html(l_jsonDataProduct[iProductCounter].gtinEANUnit);
				if(editScreen === "saveUpdate" || a_isPreviewPage == true){
					$('#productTable tr:nth('+((iProductCounter*5) + 1)+') td:nth(11)').html(l_jsonDataProduct[iProductCounter].eanOuter);
					$('#productTable tr:nth('+((iProductCounter*5) + 1)+') td:nth(12)').html(l_jsonDataProduct[iProductCounter].eanInner);
					$('#productTable tr:nth('+((iProductCounter*5) + 1)+') td:nth(13)').html(l_jsonDataProduct[iProductCounter].eanUnit);
				}
				$('#productTable tr:nth('+((iProductCounter*5) + 1)+') td:nth(14)').html(l_jsonDataProduct[iProductCounter].gtinworkflowStatus);
				$('#productTable tr:nth('+((iProductCounter*5) + 1)+') td:nth(15)').html(l_jsonDataProduct[iProductCounter].productOverrideChckBoxState);
				$('#productTable tr:nth('+((iProductCounter*5) + 1)+') td:nth(16)').html(l_jsonDataProduct[iProductCounter].eProductOverrideChckBoxState);
				$('#productTable tr:nth('+((iProductCounter*5) + 1)+') td:nth(17)').html(l_jsonDataProduct[iProductCounter].rowIdBoProduct);
				$('#productTable tr:nth('+((iProductCounter*5) + 1)+') td:nth(18)').html(l_jsonDataProduct[iProductCounter].rowIdBoProductPkg);
				$('#productTable tr:nth('+((iProductCounter*5) + 1)+') td:nth(19)').html(l_jsonDataProduct[iProductCounter].rowIdBoProductPkgUom);
				
				$('#productTable tr:nth('+((iProductCounter*5) + 4)+') td:nth(0)').html(l_jsonDataProduct[iProductCounter].grossWeight);
				$('#productTable tr:nth('+((iProductCounter*5) + 4)+') td:nth(1)').html(l_jsonDataProduct[iProductCounter].netWeight);
				$('#productTable tr:nth('+((iProductCounter*5) + 4)+') td:nth(2)').html(l_jsonDataProduct[iProductCounter].length);
				$('#productTable tr:nth('+((iProductCounter*5) + 4)+') td:nth(3)').html(l_jsonDataProduct[iProductCounter].width);
				$('#productTable tr:nth('+((iProductCounter*5) + 4)+') td:nth(4)').html(l_jsonDataProduct[iProductCounter].height);
				$('#productTable tr:nth('+((iProductCounter*5) + 4)+') td:nth(5)').html(l_jsonDataProduct[iProductCounter].volume);
				$('#productTable tr:nth('+((iProductCounter*5) + 4)+') td:nth(6)').html(l_jsonDataProduct[iProductCounter].caseCarton);
				$('#productTable tr:nth('+((iProductCounter*5) + 4)+') td:nth(7)').html(l_jsonDataProduct[iProductCounter].gross);
				$('#productTable tr:nth('+((iProductCounter*5) + 4)+') td:nth(8)').html(l_jsonDataProduct[iProductCounter].dozen);
				$('#productTable tr:nth('+((iProductCounter*5) + 4)+') td:nth(9)').html(l_jsonDataProduct[iProductCounter].bag);
				$('#productTable tr:nth('+((iProductCounter*5) + 4)+') td:nth(10)').html(l_jsonDataProduct[iProductCounter].box);
				$('#productTable tr:nth('+((iProductCounter*5) + 4)+') td:nth(11)').html(l_jsonDataProduct[iProductCounter].displayDispenser);
				$('#productTable tr:nth('+((iProductCounter*5) + 4)+') td:nth(12)').html(l_jsonDataProduct[iProductCounter].pack);
				$('#productTable tr:nth('+((iProductCounter*5) + 4)+') td:nth(13)').html(l_jsonDataProduct[iProductCounter].retailPack);
				$('#productTable tr:nth('+((iProductCounter*5) + 4)+') td:nth(14)').html(l_jsonDataProduct[iProductCounter].bundle);
				$('#productTable tr:nth('+((iProductCounter*5) + 4)+') td:nth(15)').html(l_jsonDataProduct[iProductCounter].kit);
				
				/*if(gbu == "SEXUAL WELLNESS"){
					$('#productTable tr:nth('+((iProductCounter*5) + 4)+') td:nth(16)').html(l_jsonDataProduct[iProductCounter].packCount);
				}*/
				
				if(l_jsonDataProduct[iProductCounter].packCount != undefined || gbu == "SEXUAL WELLNESS"){
					$('#productTable tr:nth('+((iProductCounter*5) + 4)+') td:nth(16)').html(l_jsonDataProduct[iProductCounter].packCount);
					
					$('#productTable tr:nth('+((iProductCounter*5) + 1)+') td:nth(6)').html(l_jsonDataProduct[iProductCounter].variant);
					
					$('#productTable tr:nth('+((iProductCounter*5) + 1)+') td:nth(7)').html(l_jsonDataProduct[iProductCounter].productDescSuffix);
				}
				$('#productTable tr:nth('+((iProductCounter*5) + 5)+') td:nth(1)').html(l_jsonDataProduct[iProductCounter].packagingConf);
				$('#productTable tr:nth('+((iProductCounter*5) + 5)+') td:nth(2)').find(".comments label:nth(1)").html(l_jsonDataProduct[iProductCounter].comments);
				
			}//end of for loop
			if(a_isPreviewPage){
				$(".dropdown").remove();	
			}
			
			if(workflowStatus.toUpperCase()  === 'REJECTED'){
				workflowStatusDisableIcon();
			}
			disbaleProperties(stepNumber);
			updateProperties(stepNumber);
	 	}
 	});
}

function loadProductPopupData(){
	if(currrentClickedIndex < 0){
		return;
	}
	$("#productPopup #iProductId").val($('#productTable tr:nth('+currrentClickedIndex+') td:nth(1)').text());
	$("#productPopup #oracleProductID").val($('#productTable tr:nth('+currrentClickedIndex+') td:nth(2)').text());
	$("#productPopup #productID").val($('#productTable tr:nth('+currrentClickedIndex+') td:nth(4)').text());
	$("#productPopup #eProductId").val($('#productTable tr:nth('+currrentClickedIndex+') td:nth(3)').text());
	
	if(emptyFields != true){
		$("#productPopup #size").val($('#productTable tr:nth('+currrentClickedIndex+') td:nth(5)').text());
		
		if($("#productPopup #size").val() != ''){
		fetchLookUpVal(gbu, 'SIZE CODE', 'SIZE', $("#productPopup #size").val(), 'sizeCode');
		}else{
			$("#productPopup #sizeCode").val("");
		}
		$("#productPopup #gtinEanOuter").val($('#productTable tr:nth('+currrentClickedIndex+') td:nth(8)').text());
		$("#productPopup #gtinEanInner").val($('#productTable tr:nth('+currrentClickedIndex+') td:nth(9)').text());
		$("#productPopup #gtinEanUnit").val($('#productTable tr:nth('+currrentClickedIndex+') td:nth(10)').text());
	}else{
		emptyFields = false;
	}
	$("#productPopup #eANOuter").val($('#productTable tr:nth('+currrentClickedIndex+') td:nth(11)').text());
	$("#productPopup #eANInner").val($('#productTable tr:nth('+currrentClickedIndex+') td:nth(12)').text());
	$("#productPopup #eANUnit").val($('#productTable tr:nth('+currrentClickedIndex+') td:nth(13)').text());
	$("#productPopup #workflowStatus").text($('#productTable tr:nth('+currrentClickedIndex+') td:nth(14)').text());
	$("#productPopup #myToggleButton").attr("checked", $('#productTable tr:nth('+currrentClickedIndex+') td:nth(15)').text()== "true");
	$("#productPopup #eProductIdToggleButton").attr("checked", $('#productTable tr:nth('+currrentClickedIndex+') td:nth(16)').text()== "true");
	$("#productPopup #rowIdBoProduct").val($('#productTable tr:nth('+currrentClickedIndex+') td:nth(17)').text());
	$("#productPopup #rowIdBoProductPkg").val($('#productTable tr:nth('+currrentClickedIndex+') td:nth(18)').text());
	$("#productPopup #rowIdBoProductPkgUom").val($('#productTable tr:nth('+currrentClickedIndex+') td:nth(19)').text());
	
	if($('#productTable tr:nth('+currrentClickedIndex+') td:nth(15)').text() == "true"){
		$("#productPopup #productOverride").val($('#productTable tr:nth('+currrentClickedIndex+') td:nth(4)').text());
	}else{
		$("#productPopup #productID").val($('#productTable tr:nth('+currrentClickedIndex+') td:nth(4)').text());
	}
	
	if($('#productTable tr:nth('+currrentClickedIndex+') td:nth(16)').text() == "true"){
		$("#productPopup #eProductIdOverride").val($('#productTable tr:nth('+currrentClickedIndex+') td:nth(3)').text());
	}else{
		$("#productPopup #eProductId").val($('#productTable tr:nth('+currrentClickedIndex+') td:nth(3)').text());
	}
	
	$("#productPopup #eProductId").val($('#productTable tr:nth('+currrentClickedIndex+') td:nth(3)').text());
	$("#productPopup #grossWeight").val($('#productTable tr:nth('+(currrentClickedIndex+3)+') td:nth(0)').text());
	$("#productPopup #netWeight").val($('#productTable tr:nth('+(currrentClickedIndex+3)+') td:nth(1)').text());
	$("#productPopup #length").val($('#productTable tr:nth('+(currrentClickedIndex+3)+') td:nth(2)').text());
	$("#productPopup #width").val($('#productTable tr:nth('+(currrentClickedIndex+3)+') td:nth(3)').text());
	$("#productPopup #height").val($('#productTable tr:nth('+(currrentClickedIndex+3)+') td:nth(4)').text());
	$("#productPopup #volume").val($('#productTable tr:nth('+(currrentClickedIndex+3)+') td:nth(5)').text());
	$("#productPopup #caseCarton").val($('#productTable tr:nth('+(currrentClickedIndex+3)+') td:nth(6)').text());
	$("#productPopup #bag").val($('#productTable tr:nth('+(currrentClickedIndex+3)+') td:nth(9)').text());
	$("#productPopup #displayDispenser").val($('#productTable tr:nth('+(currrentClickedIndex+3)+') td:nth(11)').text());
	$("#productPopup #comments").val($('#productTable tr:nth('+(currrentClickedIndex+4)+') td:nth(2)').text().split('-')[1].trim());
	
	
	$("#productPopup #measuresInformation").html($('#productTable tr:nth('+(currrentClickedIndex+4)+') td:nth(1)').text());
	
	if($('#productTable tr:nth('+(currrentClickedIndex+3)+') td:nth(7)').text() != ""){
		$("select option[value= Gross]").prop('disabled', true);
		selectedMeasuresDropdownIds.push("Gross");
		messageMeasuresName.push("Gross");
		var gross = $('#productTable tr:nth('+(currrentClickedIndex+3)+') td:nth(7)').text();
		measuresValue.push(gross);
		messageMeasuresValue.push(gross);
	}
	if($('#productTable tr:nth('+(currrentClickedIndex+3)+') td:nth(8)').text() != ""){
		$("select option[value= Dozen]").prop('disabled', true);
		selectedMeasuresDropdownIds.push("Dozen");
		messageMeasuresName.push("Dozen");
		var dozen = $('#productTable tr:nth('+(currrentClickedIndex+3)+') td:nth(8)').text();
		measuresValue.push(dozen);
		messageMeasuresValue.push(dozen);
	}
	if($('#productTable tr:nth('+(currrentClickedIndex+3)+') td:nth(10)').text() != ""){
		$("select option[value= Box]").prop('disabled', true);
		selectedMeasuresDropdownIds.push("Box");
		messageMeasuresName.push("Box");
		var box = $('#productTable tr:nth('+(currrentClickedIndex+3)+') td:nth(10)').text();
		measuresValue.push(box);
		messageMeasuresValue.push(box);
	}
	if($('#productTable tr:nth('+(currrentClickedIndex+3)+') td:nth(12)').text() != ""){
		$("select option[value= Pack]").prop('disabled', true);
		selectedMeasuresDropdownIds.push("Pack");
		messageMeasuresName.push("Pack");
		var pack = $('#productTable tr:nth('+(currrentClickedIndex+3)+') td:nth(12)').text();
		measuresValue.push(pack);
		messageMeasuresValue.push(pack);
	}
	if($('#productTable tr:nth('+(currrentClickedIndex+3)+') td:nth(13)').text() != ""){
		$("select option[value= Retail_Pack]").prop('disabled', true);
		selectedMeasuresDropdownIds.push("Retail Pack");
		messageMeasuresName.push("Retail Pack");
		var retailpack = $('#productTable tr:nth('+(currrentClickedIndex+3)+') td:nth(13)').text();
		measuresValue.push(retailpack);
		messageMeasuresValue.push(retailpack);
	}
	if($('#productTable tr:nth('+(currrentClickedIndex+3)+') td:nth(14)').text() != ""){
		$("select option[value= Bundle]").prop('disabled', true);
		selectedMeasuresDropdownIds.push("Bundle");
		messageMeasuresName.push("Bundle");
		var bundle = $('#productTable tr:nth('+(currrentClickedIndex+3)+') td:nth(14)').text();
		measuresValue.push(bundle);
		messageMeasuresValue.push(bundle);
	}
	if($('#productTable tr:nth('+(currrentClickedIndex+3)+') td:nth(15)').text() != ""){
		$("select option[value= Kit]").prop('disabled', true);
		selectedMeasuresDropdownIds.push("Kit");
		messageMeasuresName.push("Kit");
		var kit = $('#productTable tr:nth('+(currrentClickedIndex+3)+') td:nth(15)').text();
		measuresValue.push(kit);
		messageMeasuresValue.push(kit);
	}
	/*if(gbu == "SEXUAL WELLNESS"){*///For packCount
		$("#productPopup #packCount").val($('#productTable tr:nth('+(currrentClickedIndex+3)+') td:nth(16)').text());
		$("#productPopup #variant").val($('#productTable tr:nth('+currrentClickedIndex+') td:nth(6)').text());
		$("#productPopup #productDescSuffix").val($('#productTable tr:nth('+currrentClickedIndex+') td:nth(7)').text());
	/*}*/
	
	showMeasuresData();	
	
	/** 
	 * Maintaining Sequence of Packaging Configuration 
	 * START
	 * **/	
	var packagingConfig = $('#productTable tr:nth('+(currrentClickedIndex+4)+') td:nth(1)').text(); // arranging message in proper sequence
	var packagingConfigArray = packagingConfig.split(",");
	packagingConfig=""; 
	for(var packagingIndex = 0; packagingIndex < packagingConfigArray.length; packagingIndex++){
		packagingConfig += packagingConfigArray[packagingIndex].split("=")[0];
	}
	
	packagingConfigArray = packagingConfig.split("1 ");
	packagingInfoArray = []; 
	var iPackagingCounter=0;
	for(var iPackagingConfigCounter = 0; iPackagingConfigCounter < packagingConfigArray.length; iPackagingConfigCounter++){ // pushing the data in sequence into packagingInfoArray
		if(iPackagingConfigCounter != 0){
			packagingInfoArray[iPackagingCounter] = packagingConfigArray[iPackagingConfigCounter].trim(); 
			iPackagingCounter++;
		}
	}
	/**
	 * ENDS
	 */
	
	
	$("#measures").val('');
	$("#measuresValueTextbox").val('');
	updateProperties(stepNumber);
}

function volumeCalculation(){
	var length = $("#productPopup #length").val()/100;//conversion of cm to m
	var width = $("#productPopup #width").val()/100;
	var height = $("#productPopup #height").val()/100;

	if($.isNumeric(length) && $.isNumeric(width) && $.isNumeric(height)){
			var volume;
			volume = (length * width * height);
			var fixedVolume = (parseFloat(volume)).toFixed(5);
			if(fixedVolume.indexOf("e+")!== -1){
				fixedVolume = parseFloat(fixedVolume);
				var volumeWithoutExponent = fixedVolume.noExponents();
				$("#productPopup #volume").val(volumeWithoutExponent);
			}else{
				$("#productPopup #volume").val(fixedVolume);
			}
	}else{
			$("#productPopup #volume").val("");
	}
}

function isNumericFields(){
	 var validationArray = new Array();
	 
	 if($("#grossWeight").val().indexOf(".") != -1){//To check whether numeric value inside grossWeight field contains "."
		 var numbersAfterDecimalInHeight = ($("#productPopup #grossWeight").val().split('.')[1]).length;
		 if(numbersAfterDecimalInHeight > 4){//To check whether the field contains four digits after decimal point
			validationArray.push([false,"grossWeight","grossWeight","longDecimalValueError"]);
		}else{
			 $("#productPopup #grossWeight").css("border-color","#ccc");
		 }
	 }
	 
	 if($("#netWeight").val().indexOf(".") != -1){//To check whether numeric value inside netWeight field contains "."
		 var numbersAfterDecimalInHeight = ($("#productPopup #netWeight").val().split('.')[1]).length;
		 if(numbersAfterDecimalInHeight > 4){//To check whether the field contains four digits after decimal point
			validationArray.push([false,"netWeight","netWeight","longDecimalValueError"]);
		}else{
			 $("#productPopup #netWeight").css("border-color","#ccc");
		 }
	 }
	 
	 if($("#length").val().indexOf(".") != -1){//To check whether numeric value inside length field contains "."
		 var numbersAfterDecimalInLength = ($("#productPopup #length").val().split('.')[1]).length;
		 if(numbersAfterDecimalInLength > 4){//To check whether the field contains four digits after decimal point
			validationArray.push([false,"length","length","longDecimalValueError"]);
		}else{
			 $("#productPopup #length").css("border-color","#ccc");
		 } 
	 }
	 
	 if($("#width").val().indexOf(".") != -1){//To check whether numeric value inside width field contains "."
		 var numbersAfterDecimalInWidth = ($("#productPopup #width").val().split('.')[1]).length;
		 if(numbersAfterDecimalInWidth > 4){//To check whether the field contains four digits after decimal point
			validationArray.push([false,"width","width","longDecimalValueError"]);
		}else{
			$("#productPopup #width").css("border-color","#ccc");
		}
	 }
	 
	 if($("#height").val().indexOf(".") != -1){//To check whether numeric value inside height field contains "."
		 var numbersAfterDecimalInHeight = ($("#productPopup #height").val().split('.')[1]).length;
		 if(numbersAfterDecimalInHeight > 4){//To check whether the field contains four digits after decimal point
			validationArray.push([false,"height","height","longDecimalValueError"]);
		}else{
			 $("#productPopup #height").css("border-color","#ccc");
		 }
	 }
	 
	 var charachterAllowed = /[^\\\\A-Za-z0-9()-\.,/& "]/;
	 if($('#myToggleButton').prop('checked') == true){
		 if($("#productOverride").val().match('\\*')){
			 validationArray.push([false,"productOverride","Product Description","noSpecialCharchters"]);
		 }else if($("#productOverride").val().match(charachterAllowed)){
			 validationArray.push([false,"productOverride","Product Description","noSpecialCharchters"]);
		 }
	 }else{
		 if($("#productID").val().match('\\*')){
			 validationArray.push([false,"productOverride","Product Description","noSpecialCharchters"]);
		 }else if($("#productID").val().match(charachterAllowed)){
			 validationArray.push([false,"productOverride","Product Description","noSpecialCharchters"]);
		 }
	 }
	 return validationArray;
}

function measuresSelection() {
	selectedMeasuresDropdownIds = new Array();
	measuresValue = new Array();
	
	if($('#measures option:selected').text() != "" && $("#productPopup #measuresValueTextbox").val() != ""){
		selectedMeasuresDropdownIds.push($('#measures option:selected').text());
		messageMeasuresName.push($('#measures option:selected').text());
		measuresValue.push($("#productPopup #measuresValueTextbox").val());
		messageMeasuresValue.push($("#productPopup #measuresValueTextbox").val());
		showMeasuresData();
		for(var iMeasuresCounter = 0; iMeasuresCounter <selectedMeasuresDropdownIds.length; iMeasuresCounter++){
			if(selectedMeasuresDropdownIds[iMeasuresCounter] == "Retail Pack"){
				selectedMeasuresDropdownIds[iMeasuresCounter] = "Retail_Pack";
			}
			$("select option[value=" + selectedMeasuresDropdownIds[iMeasuresCounter] + "]").prop('disabled', true);
		}
		$("#measures").val('');
		$("#measuresValueTextbox").val('');
		selectedMeasuresDropdownIds.pop();
		measuresValue.pop();
		measuresIndex++;
	}else{
		return false;
	}
}

function showMeasuresData(){
	for(iDynamicData = 0 ; iDynamicData < selectedMeasuresDropdownIds.length ; iDynamicData++){
		var displayValue = 
			"<tr id=\'dynamicData"+dynamicTableId+"\' class="+'"'+selectedMeasuresDropdownIds[iDynamicData]+'"'+">" +
			"<td id=\'measuresName"+dynamicTableId+"\'>"+ selectedMeasuresDropdownIds[iDynamicData]+ "</td>" +
			"<td>=</td><td id=\'measuresValue"+dynamicTableId+"\'>"+ measuresValue[iDynamicData]+ "</td>" +
			"<td><input type='button' id='editRow' name='editRow' value='edit' class='edit-btn-cls center-img-cls' onclick=\'editInnerTableMeasuresAndSubRegion("+dynamicTableId+",\"measuresName\",\"measuresValue\")\'></td>" +
			"<td><input type='button' id='deleteRow' name='deleteRow' value='delete' class='delet-btn-cls center-img-cls' onclick=\'deleteItem(\"display\","+dynamicTableId+")\'></td>" +
			"</tr>"
		$("#display").append(displayValue);
		packagingInfoArray.push(selectedMeasuresDropdownIds[iDynamicData]);
		dynamicTableId++;
	}
}

function showPackagingConfigurationMessage(){
	$("#measuresInformation").html('');
	var message = '';
	if($("#caseCarton").val() != null && $("#caseCarton").val() !=""){
		messageMeasuresName.push("Case");
		messageMeasuresValue.push($("#caseCarton").val());
	}
	if($("#displayDispenser").val() != null && $("#displayDispenser").val() !=""){
		messageMeasuresName.push("DD");
		messageMeasuresValue.push($("#displayDispenser").val());
	}
	if($("#bag").val() != null && $("#bag").val() !=""){
		messageMeasuresName.push("Bag");
		messageMeasuresValue.push($("#bag").val());
	}
		for(var packagingIndex = 0 ; packagingIndex < packagingInfoArray.length ; packagingIndex++){
			for(iMeasuresCounter = 0 ; iMeasuresCounter < messageMeasuresName.length ; iMeasuresCounter++){
				if(packagingInfoArray[packagingIndex].toUpperCase() == messageMeasuresName[iMeasuresCounter].toUpperCase()){
					var Measuremessage = "1 " + messageMeasuresName[iMeasuresCounter]+" ="+messageMeasuresValue[iMeasuresCounter]+" pieces, <wbr>" ;
					message += Measuremessage;
					break;
				}
			}
		}
		
	
	if(message != ''){
		message = "<p>" + message.substring(0, message.length-7) + "<wbr></p>";
	}
	$("#measuresInformation").html(message);
}

function getPackagingInfoSeq(packagingInfoObj){
	var isPresent = false;
	if($(packagingInfoObj).val()!=""){		// To check whether the packagingInfoObj values is not equal to blank
		for(var iPackagingInfCounter = 0 ; iPackagingInfCounter < packagingInfoArray.length ;iPackagingInfCounter ++){//To check whether packagingInfoObj value into packagingInfoArray
			if(packageConfigurationEnum[packagingInfoObj.id] == packagingInfoArray[iPackagingInfCounter]){
				isPresent = true;
				break;
			}	
		}
		if(isPresent == false){
			packagingInfoArray.push(packageConfigurationEnum[packagingInfoObj.id]);		// if value is already present into the array then don't push it again	
		}
	}else{
		for(var iPackagingInfCounter = 0 ; iPackagingInfCounter < packagingInfoArray.length ;iPackagingInfCounter ++){
			if(packagingInfoArray[iPackagingInfCounter] == packageConfigurationEnum[packagingInfoObj.id]){
				packagingInfoArray.splice(iPackagingInfCounter,1);
				break;
			}
		}
	}
}


function editInnerTableMeasuresAndSubRegion(position,nameId,valueId,rowId){
	var innerTableMeasuresOrSubRegionName = $("tr#dynamicData" + position + " #"+nameId+""+position).html().trim();
	var innerTableMeasuresOrSubRegionValue = $("tr#dynamicData" + position + " #"+valueId+""+position).html();
	var rowIdValue = $("tr#dynamicData" + position + " #"+rowId+""+position).html();
	for(iInnerTableMeasuresOrSubRegionCounter = 0 ; iInnerTableMeasuresOrSubRegionCounter < messageMeasuresName.length ; iInnerTableMeasuresOrSubRegionCounter++){
		if(messageMeasuresName[iInnerTableMeasuresOrSubRegionCounter] == innerTableMeasuresOrSubRegionName){
			messageMeasuresName.splice(iInnerTableMeasuresOrSubRegionCounter, 1);
			messageMeasuresValue.splice(iInnerTableMeasuresOrSubRegionCounter, 1);
			break;
		}
	}
	for(var iPackagingInfCounter = 0 ; iPackagingInfCounter < packagingInfoArray.length ;iPackagingInfCounter ++){
		if(packagingInfoArray[iPackagingInfCounter] == innerTableMeasuresOrSubRegionName){
			packagingInfoArray.splice(iPackagingInfCounter,1);
			break;
		}
	}
	if (position != undefined && position!= null && nameId == "measuresName") {
		$("tr#dynamicData"+position).remove();
	
		if(innerTableMeasuresOrSubRegionName == "Retail Pack"){
			innerTableMeasuresOrSubRegionName = "Retail_Pack";
			$("select option[value*=" + innerTableMeasuresOrSubRegionName + "]").prop('disabled', false);
		}else{
			$("select option[value*=" + innerTableMeasuresOrSubRegionName + "]").prop('disabled', false);
		}
		$("#productPopup #measures").val(innerTableMeasuresOrSubRegionName);
		$("#productPopup #measuresValueTextbox").val(innerTableMeasuresOrSubRegionValue);
	}else{
		$("tr#dynamicData"+position).remove();
		fetchLookUpVal(null, 'ORGS IN SUB REGION', 'Sub Region', innerTableMeasuresOrSubRegionName, 'orgsSubRegionNALAC');
		$("select option[value*=" + innerTableMeasuresOrSubRegionName.replace(/ +/g, "") + "]").prop('disabled', false);
		$("#regionspopup #subRegionNALAC").val(innerTableMeasuresOrSubRegionName.replace(/ +/g, ""));
		$("#regionspopup #orgsSubRegionNALAC").val(innerTableMeasuresOrSubRegionValue);
		$("#regionspopup #rowIdSubRegion").val(rowIdValue);
		var removedItem = new Array();
		removedItem = subRegionArr.splice(position ,1);
	}
}

function hideNextThreeRow(productRowRecord){
	var a_rowNumber = $("table tr").index($(productRowRecord).closest("tr"));
	$(productRowRecord).find("span").toggleClass('plusicon');
	$("#productTable tr:nth("+(a_rowNumber+1)+")").toggle();
	$("#productTable tr:nth("+(a_rowNumber+2)+")").toggle();
	$("#productTable tr:nth("+(a_rowNumber+3)+")").toggle();
	$("#productTable tr:nth("+(a_rowNumber+4)+")").toggle();
	
}

function hideWholeTable(){
	if(jQuery(".first-row-cls > td:first-child span").hasClass('plusicon')){
		jQuery("#productTable tr:not(:first)").show();
		jQuery("#productTable tr:not(:first) .toggleicon").removeClass('plusicon');
	}else{
		jQuery("#productTable tr:not(:first)").hide();
	}
	jQuery(".first-row-cls > td:first-child span").toggleClass('plusicon');
}

function clearProductEditorFields(){
	populateDataByFormula();
	$("#productPopup #oracleProductId").val("");
	$("#productPopup #iProductId").val("");
	/*$("#productPopup #eProductId").val("");*/
	/*$("#productPopup #productID").val("");*/
	$("#productPopup #size").val("");
	$("#productPopup #gtinEanOuter").val("");
	$("#productPopup #gtinEanInner").val("");
	$("#productPopup #gtinEanUnit").val("");
	$("#productPopup #grossWeight").val("");
	$("#productPopup #netWeight").val("");
	$("#productPopup #length").val("");
	$("#productPopup #width").val("");
	$("#productPopup #height").val("");
	$("#productPopup #volume").val("");
	$("#productPopup #caseCarton").val("");
	$("#productPopup #bag").val("");
	$("#productPopup #comments").val("");
	$("#productPopup #displayDispenser").val("");
	$("#productPopup #variant").val("");
	$("#productPopup #productDescSuffix").val("");
	$("#productPopup #packCount").val("");
	$("#productPopup #rowIdBoProduct").val("");
	$("#productPopup #rowIdBoProductPkg").val("");
	$("#productPopup #rowIdBoProductPkgUom").val("");
	$("#productPopup #eANOuter").val("");
	$("#productPopup #eANInner").val("");
	$("#productPopup #eANUnit").val("");
	
	$("#productPopup #eProductId").css("border-color","#ccc");
	$("#productPopup #size").css("border-color","#ccc");
	$("#productPopup #gtinEanOuter").css("border-color","#ccc");
	$("#productPopup #gtinEanInner").css("border-color","#ccc");
	$("#productPopup #gtinEanUnit").css("border-color","#ccc");
	$("#productPopup #productID").css("border-color","#ccc");
	$("#productPopup #grossWeight").css("border-color","#ccc");
	$("#productPopup #netWeight").css("border-color","#ccc");
	$("#productPopup #caseCarton").css("border-color","#ccc");
	$("#productPopup #length").css("border-color","#ccc");
	$("#productPopup #width").css("border-color","#ccc");
	$("#productPopup #height").css("border-color","#ccc");
	
	for(var iMeasuereCounter = 0; iMeasuereCounter <messageMeasuresName.length; iMeasuereCounter++){
		if(messageMeasuresName[iMeasuereCounter] == "Retail Pack"){
			messageMeasuresName[iMeasuereCounter] = "Retail_Pack";
		}
		$("select option[value=" + messageMeasuresName[iMeasuereCounter] + "]").prop('disabled', false);
	}
	$("#productPopup #measuresValueTextbox").val("");
	$("#productPopup #measuresInformation").html("");
	$("#productPopup #displayValues #display tr").remove();
	messageMeasuresName = new Array();
	messageMeasuresValue = new Array();
	$("#size").focus();
	fetchLookUpVal(gbu,'SIZE',null,null,'size');
}	


/////////////////////////-------------------PRODUCT ends---------------------------

/////////////////////////-------------------copy Product starts---------------------------

function showCopyProductContent(){
	var e = document.getElementById("ollist");
    if(e.style.display == "block")
       e.style.display = "none";
    else
       e.style.display = "block";
}

function saveCopyProductData(){
	
	if(wizardObject[step_02] != ''){
		var year = new Date().getFullYear().toString();
		wizardObject[step_02]['brandList'][0].launchYear = 'FY'+year.slice(-2);
	}
	$.ajax({	
		type : "POST",
		url : "copyProduct",
		data : {
				"gbu" : JSON.stringify(wizardObject[step_01]),
				"brand" : JSON.stringify(wizardObject[step_02]),
				"product" : JSON.stringify(wizardObject[step_03]),
				"sos" : JSON.stringify(wizardObject[step_04]),
				"region" : JSON.stringify(wizardObject[step_05]),
			   },
		async : true,
		success: function(data){
			$("#wizardsteps").html(data);
			$('.wizard_cover').show();
			$('.button-block-next').show();
			isCopyProduct = true;
			editScreen = "copyProduct";
			if(wizardObject[step_01] != null && wizardObject[step_01] != '' && stepNumber != 1){
				var gbuHeading = ""
					+ "<ul><li><span>GBU</span>"
					+ wizardObject[step_01]['gbuList'][0].gbu
					+ "</li><li> <span>Product Type</span>"
					+ wizardObject[step_01]['gbuList'][0].productType
					+ "</li><li><span>Product Create/Update Reason</span>"
					+ wizardObject[step_01]['gbuList'][0].productCreateUpdateReason
					+ "</li><li><span>Workflow/Product Approver Group</span>"
					+ wizardObject[step_01]['gbuList'][0].productApproverGroup + "</li></ul>"
					$("#gbuHeading").html(gbuHeading);
			}
		}
	});
}


/////////////////////////-------------------copy Product ends---------------------------

function populateDataByFormula(obj){
	//a_key is the group id and a_value is the array
	var	tempJson;
	if(obj != null && obj != ''){
		tempJson = JSON.stringify(obj);
	}
	else{
		tempJson = JSON.stringify(tempJsonObject);
	}
	
	
	if (stepNumber == 1) {
		tempJson = "{" + '"gbuList"' + ":" + tempJson + "}";
		$.each(completeJsonArr, function( index, obj) {
					if("gbuList" in obj){
						completeJsonArr.splice(index,1);
						return false;
					}
				});
		
	} else if (stepNumber == 2) {
		tempJson = "{" + '"brandList"' + ":" + tempJson + "}";
				$.each(completeJsonArr, function( index, obj) {
					if("brandList" in obj){
						completeJsonArr.splice(index,1);
						return false;
					}
				});
			
	} else if (stepNumber == 3) {
		tempJson = "{" + '"productList"' + ":" + tempJson + "}";
			$.each(completeJsonArr, function( index, obj) {
				if("productList" in obj){
					completeJsonArr.splice(index,1);
					return false;
				}
			});
		
	} else if (stepNumber == 4) {
		tempJson = "{" + '"sosList"' + ":" + tempJson + "}";
		$.each(completeJsonArr, function( index, obj) {
				if("sosList" in obj){
					completeJsonArr.splice(index,1);
					return false;
				}
			});
		
	} else if (stepNumber == 5) {
		tempJson = "{" + '"regionList"' + ":" + tempJson + "}";
		$.each(completeJsonArr, function( index, obj) {
				if("regionList" in obj){
					completeJsonArr.splice(index,1);
					return false;
				}
			});
	}
	if(stepNumber < 6){
		completeJsonArr.push(JSON.parse(tempJson));
	}
	jQuery.each(formulaGroups, function(a_key, a_value){
		var previousResult = null;
		for (var iRuleCounter = 0; iRuleCounter < a_value.length; iRuleCounter++) { 
			var l_ruleElement = a_value[iRuleCounter];
			
			if(l_ruleElement.businessRule=='VALIDATION'){
				//TODO: validate the rule and if fails, break;
				if(l_ruleElement.lhsType == "XPATH"){
					lhsVal = getFieldValue(l_ruleElement.lhsValue);
					if(lhsVal == ""){
						break;
					}
				}
			}else{
				var lhsVal = null;
				var rhsVal = null;
				var result = null;
				var operatorStr = null;
				
				if(l_ruleElement.lhsType == "XPATH"){
					lhsVal = getFieldValue(l_ruleElement.lhsValue);
				}else if(l_ruleElement.lhsType == "CONSTANT"){
					lhsVal = l_ruleElement.lhsValue;
				}else if(l_ruleElement.lhsType == "RESULT"){
					lhsVal = previousResult;
				}else if(l_ruleElement.lhsType == "XPATHELEMENT"){
					$("#"+ l_ruleElement.lhsValue).val(previousResult);
					if(obj != null && obj != '' &&  l_ruleElement.fieldName in obj){
						obj[l_ruleElement.fieldName] = previousResult;
					}
					break;
				}
				
				
				if(l_ruleElement.rhsType == "XPATH"){
					rhsVal = getFieldValue(l_ruleElement.rhsValue);
				}else if(l_ruleElement.rhsType == "CONSTANT"){
					rhsVal = l_ruleElement.rhsValue;
				}else if(l_ruleElement.rhsType == "RESULT"){
					rhsVal = previousResult;
				}
				
				if(l_ruleElement.operator == "PLUS"){
					result = lhsVal + rhsVal;
				}
				else if(l_ruleElement.operator == "MINUS"){
					result = lhsVal - rhsVal;
				}
				
				previousResult = result;
			}
		}
	});
	tempJsonObject.length = 0;
}

//-------------------------- To Decode Entities from Defiant.js --------------------------// 
function decodeEntities(encodedString) {
    var textArea = document.createElement('textarea');
    textArea.innerHTML = encodedString;
    return textArea.value;
}

//-------------------------- End of Decode Entities --------------------------//

function getFieldValue(a_xPath){
	//TODO: return the value from wizard master based on the xPath
	var snapshot = Defiant.getSnapshot(completeJsonArr);
	var valueArr = JSON.search(snapshot, a_xPath);
	if(valueArr[0] != undefined){
		return decodeEntities(valueArr[0]);
	}
	else{
		return "";
	}
	/*var valueArr;
	if(a_xPath.includes("//productList/sizeCode")){
		valueArr = JSON.search(snapshot, "//productList/size");
		if(valueArr[0] != undefined && valueArr[0] != ""){
			valueArr = JSON.search(snapshot, a_xPath);
			return valueArr[0];
		}
		else{
			return "";
		}
	}else{
		valueArr = JSON.search(snapshot, a_xPath);
		if(valueArr[0] != undefined){
			return valueArr[0];
		}
		else{
			return "";
		}
	}*/
	/*var valueArr = JSON.search(snapshot, a_xPath);
	if(valueArr[0] != undefined){
		return valueArr[0];
	}
	else{
		return "";
	}*/
}



/////////////////////////------------------- NEW SOS FOR EMEA/APAC starts --------------------------------------------// 


/**
 * @author Shivam.Mishra
 * @param <code> NEW SOS FOR EMEA/APAC </code>
 */

function saveNewSOSForEMEA(){
	var isValid = false;
	var regionListLength = wizardObject[step_05]['regionList'].length;
	for(var regionListCounter=0 ;regionListCounter < regionListLength ; regionListCounter++ ){
		
		var regionName = wizardObject[4]['regionList'][regionListCounter]['name'];
		if(regionName === "EMEA" || regionName === "APAC" || regionName === "EMEA-SW"){
			isValid = true;
			
			if(wizardObject[step_02] != ''){
				var year = new Date().getFullYear().toString();
				wizardObject[step_02]['brandList'][0].launchYear = 'FY'+year.slice(-2);
			}
						
			$.ajax({
				type 	: "POST",
				url  	: "saveNewSOSForEMEA",
				async	: true,
				data 	:{
					
					"gbu" : JSON.stringify(wizardObject[step_01]),
					"brand" : JSON.stringify(wizardObject[step_02]),
					"product" : JSON.stringify(wizardObject[step_03]),
					"sos" : JSON.stringify(wizardObject[step_04]),
					"region" : JSON.stringify(wizardObject[step_05])
				},
				success	: function(data){
					$("#wizardsteps").html(data);
					$('.wizard_cover').show();
					$('.button-block-next').show();
					isCopyProduct = true;
					editScreen = "newSOSForEMEA_APAC";
					if(wizardObject[step_01] != null && wizardObject[step_01] != '' && stepNumber != 1){
						var gbuHeading = ""
							+ "<ul><li><span>GBU</span>"
							+ wizardObject[step_01]['gbuList'][0].gbu
							+ "</li><li> <span>Product Type</span>"
							+ wizardObject[step_01]['gbuList'][0].productType
							+ "</li><li><span>Product Create/Update Reason</span>"
							+ wizardObject[step_01]['gbuList'][0].productCreateUpdateReason
							+ "</li><li><span>Workflow/Product Approver Group</span>"
							+ wizardObject[step_01]['gbuList'][0].productApproverGroup + "</li></ul>"
							$("#gbuHeading").html(gbuHeading);
					}
				}
			});
			break;
		}
	}
	
	if(!isValid){
		alert("Product " +wizardObject[step_03].productList[0].internalProductID+ " is not assigned to EMEA/APAC region. Please use cross-fertilization option to add EMEA/APAC region.");
	}
	
}
// ********************************* END OF  NEW SOS FOR EMEA/APAC  *************************************// 

//-------------------------------------  NEW SOS FOR NALAC  --------------------------------------------//
/**
 * @author Shivam.Mishra
 */


function saveNewForNALAC(){
	
	var regionListLength = wizardObject[step_05]['regionList'].length;
	var isValid = false;
	if(wizardObject[step_03] != ''){
		internalIdString = '';
		var productListLength = (wizardObject[step_03].productList).length;
		for(var iProductCounter =0 ; iProductCounter <productListLength ; iProductCounter++ ){
			var message = ","+ wizardObject[step_03]['productList'][iProductCounter].internalProductID;
			internalIdString = internalIdString.concat(message);
		}
		internalIdString = internalIdString + ",";
	}
	for(var regionListCounter=0 ;regionListCounter < regionListLength ; regionListCounter++ ){
		var regionName = wizardObject[4]['regionList'][regionListCounter]['name'];
		if(regionName === "NALAC"){
			isValid =  true;
			$.ajax({
				type	:	"POST",
				url		:	"saveNewSOSForNALAC",
				async	:	true,
				data	:	{
					
					"gbu" : JSON.stringify(wizardObject[step_01]),
					"brand" : JSON.stringify(wizardObject[step_02]),
					"product" : JSON.stringify(wizardObject[step_03]),
					"sos" : JSON.stringify(wizardObject[step_04]),
					"region" : JSON.stringify(wizardObject[step_05]),
					"internalId" : internalIdString
				},
				success	: function(data){
					$("#wizardsteps").html(data);
					$('.wizard_cover').show();
					$('.button-block-next').show();
					isCopyProduct = true;
					editScreen = "saveNewSOSForNALAC";
					if(wizardObject[step_01] != null && wizardObject[step_01] != '' && stepNumber != 1){
						var gbuHeading = ""
							+ "<ul><li><span>GBU</span>"
							+ wizardObject[step_01]['gbuList'][0].gbu
							+ "</li><li> <span>Product Type</span>"
							+ wizardObject[step_01]['gbuList'][0].productType
							+ "</li><li><span>Product Create/Update Reason</span>"
							+ wizardObject[step_01]['gbuList'][0].productCreateUpdateReason
							+ "</li><li><span>Workflow/Product Approver Group</span>"
							+ wizardObject[step_01]['gbuList'][0].productApproverGroup + "</li></ul>"
							$("#gbuHeading").html(gbuHeading);
					}
					
				}
			});
		}
	}
	
	if(!isValid){
		alert("Product " +wizardObject[step_03].productList[0].internalProductID+ " is not assigned to NA/LAC region. Please use cross-fertilization option to add NA/LAC region.");
	}
}

//********************************* END OF NEW SOS FOR NALAC   *************************************// 

//---------------------------------------- Cross Fertilization -------------------------------------------

function saveNewForCrossFertilization(){
	if(wizardObject[step_03] != ''){
		internalIdString = '';
		var productListLength = (wizardObject[step_03].productList).length;
		for(var iProductCounter =0 ; iProductCounter <productListLength ; iProductCounter++ ){
			var message = ","+ wizardObject[step_03]['productList'][iProductCounter].internalProductID;
			internalIdString = internalIdString.concat(message);
		}
		internalIdString = internalIdString + ",";
	}
	
	$.ajax({
		type	:	"POST",
		url		:	"saveNewForCrossFertilization",
		async	:	true,
		data	:	{
			
			"gbu" : JSON.stringify(wizardObject[step_01]),
			"brand" : JSON.stringify(wizardObject[step_02]),
			"product" : JSON.stringify(wizardObject[step_03]),
			"sos" : JSON.stringify(wizardObject[step_04]),
			"region" : JSON.stringify(wizardObject[step_05]),
			"internalId" : internalIdString
		},
		success	: function(data){
			$("#wizardsteps").html(data);
			$('.wizard_cover').show();
			$('.button-block-next').show();
			isCopyProduct = true;
			editScreen = "saveNewForCrossFertilization";
			if(wizardObject[step_01] != null && wizardObject[step_01] != '' && stepNumber != 1){
				var gbuHeading = ""
					+ "<ul><li><span>GBU</span>"
					+ wizardObject[step_01]['gbuList'][0].gbu
					+ "</li><li> <span>Product Type</span>"
					+ wizardObject[step_01]['gbuList'][0].productType
					+ "</li><li><span>Product Create/Update Reason</span>"
					+ wizardObject[step_01]['gbuList'][0].productCreateUpdateReason
					+ "</li><li><span>Workflow/Product Approver Group</span>"
					+ wizardObject[step_01]['gbuList'][0].productApproverGroup + "</li></ul>"
					$("#gbuHeading").html(gbuHeading);
			}
		}
	});
}

//********************************* Cross Fertilization   *************************************// 



//---------------------------------------- UPDATE -------------------------------------------

function saveUpdate(){
	
	if(wizardObject[step_03] != ''){
		internalIdString = '';
		var productListLength = (wizardObject[step_03].productList).length;
		for(var iProductCounter =0 ; iProductCounter <productListLength ; iProductCounter++ ){
			var message = ","+ wizardObject[step_03]['productList'][iProductCounter].internalProductID;
			internalIdString = internalIdString.concat(message);
		}
		internalIdString = internalIdString + ",";
	}
	
	$.ajax({
		type	:	"POST",
		url		:	"saveUpdate",
		async	:	true,
		data	:	{
			
			"gbu" : JSON.stringify(wizardObject[step_01]),
			"brand" : JSON.stringify(wizardObject[step_02]),
			"product" : JSON.stringify(wizardObject[step_03]),
			"sos" : JSON.stringify(wizardObject[step_04]),
			"region" : JSON.stringify(wizardObject[step_05]),
			"internalId" : internalIdString
		},
		success	: function(data){
			$("#wizardsteps").html(data);
			$('.wizard_cover').show();
			$('.button-block-next').show();
			isCopyProduct = true;
			editScreen = "saveUpdate";
			if(wizardObject[step_01] != null && wizardObject[step_01] != '' && stepNumber != 1){
				var gbuHeading = ""
					+ "<ul><li><span>GBU</span>"
					+ wizardObject[step_01]['gbuList'][0].gbu
					+ "</li><li> <span>Product Type</span>"
					+ wizardObject[step_01]['gbuList'][0].productType
					+ "</li><li><span>Product Create/Update Reason</span>"
					+ wizardObject[step_01]['gbuList'][0].productCreateUpdateReason
					+ "</li><li><span>Workflow/Product Approver Group</span>"
					+ wizardObject[step_01]['gbuList'][0].productApproverGroup + "</li></ul>"
					$("#gbuHeading").html(gbuHeading);
			}
		}
	});
}


//********************************* END OF UPDATE   *************************************// 

//---------------------------------------- Update Procurement Data -------------------------------------------

function saveUpdateProcurementData(){
	var isValid = false;
	if(wizardObject[step_03] != ''){
		internalIdString = '';
		var productListLength = (wizardObject[step_03].productList).length;
		for(var iProductCounter =0 ; iProductCounter <productListLength ; iProductCounter++ ){
			var message = ","+ wizardObject[step_03]['productList'][iProductCounter].internalProductID;
			internalIdString = internalIdString.concat(message);
		}
		internalIdString = internalIdString + ",";
	}
	
	var regionListLength = wizardObject[step_05]['regionList'].length;
	for(var regionListCounter=0 ;regionListCounter < regionListLength ; regionListCounter++ ){
		
		var regionName = wizardObject[4]['regionList'][regionListCounter]['name'];
		if(regionName === "GTC"){
			isValid = true;
			$.ajax({
				type	:	"POST",
				url		:	"saveUpdateProcurementData",
				async	:	true,
				data	:	{
					
					"gbu" : JSON.stringify(wizardObject[step_01]),
					"brand" : JSON.stringify(wizardObject[step_02]),
					"product" : JSON.stringify(wizardObject[step_03]),
					"sos" : JSON.stringify(wizardObject[step_04]),
					"region" : JSON.stringify(wizardObject[step_05]),
					"internalId" : internalIdString,
					"editScreen" : editScreen
				},
				success	: function(data){
					$("#wizardsteps").html(data);
					$('.wizard_cover').show();
					$('.button-block-next').show();
					isCopyProduct = true;
					editScreen = "saveUpdateProcurementData";
					if(wizardObject[step_01] != null && wizardObject[step_01] != '' && stepNumber != 1){
						var gbuHeading = ""
							+ "<ul><li><span>GBU</span>"
							+ wizardObject[step_01]['gbuList'][0].gbu
							+ "</li><li> <span>Product Type</span>"
							+ wizardObject[step_01]['gbuList'][0].productType
							+ "</li><li><span>Product Create/Update Reason</span>"
							+ wizardObject[step_01]['gbuList'][0].productCreateUpdateReason
							+ "</li><li><span>Workflow/Product Approver Group</span>"
							+ wizardObject[step_01]['gbuList'][0].productApproverGroup + "</li></ul>"
							$("#gbuHeading").html(gbuHeading);
					}
				}
			});
			
		}
	}
	
	if(!isValid){
		alert("No procurement data present.")
	}
}


//********************************* END Update Procurement Data   *************************************// 

/**
 * @author Shivam.Mishra
 */

function disbaleProperties(stepNumber){	 //Disable functoinality method to disable field in Edit scenario
	if(checkEditScreen(editScreen)){
		if(stepNumber == 1){
			
			 $('.gbu-block').find('select').each(function () {
			    $(this).prop('disabled', true).css('background-color','#ccc');
			 });
			 if(editScreen === "saveNewSOSForNALAC" || editScreen === "saveNewForCrossFertilization"){
				 $('#productApproverGroup').attr('disabled',false).css('background-color' , '#fff');
			 }
		}else if(stepNumber == 2){
			
			$('.brand-block').find('input, textarea, button, select').each(function () {
			    $(this).prop('disabled', true).css('background-color','#ccc');
			});
			$('#apsPSPProductFlag').css('background-color','#ccc');
			$('#costApproved').css('background-color','#ccc');
			
		}else if(stepNumber == 3){
			
			$('#addProduct').hide();
			$('#productTable .dropbtn').hide();
			if(checkEditScreen(editScreen)){
				$('#generateID').hide();
			}
			
		}else if(stepNumber == 4){
			if(editScreen === "saveNewForCrossFertilization" || editScreen === "saveUpdateProcurementData" ){
				$('.sosBtns').find('input').each(function () {
				    $(this).prop('disabled', true);
				});
				$('.sosBtns').css('background-color','#ccc');
				$('.sosLinkClass').hide();
			}
			
		}else if(stepNumber == 5){
			
			if(editScreen != "saveNewForCrossFertilization"){
				
				if(editScreen != "saveUpdateProcurementData"){
					var regionListLength = (wizardObject[step_05].regionList).length;
					for(var icounter = 0; icounter< regionListLength ; icounter++ ){
						if(wizardObject[step_05]["regionList"][icounter]['name'] === "GTC"){
							if(wizardObject[step_05]["regionList"][icounter]['flagForEditNALAC'] == null){
								$('#gtcTable').prop("disabled",true);		
							}
						}
					}
				}
				$('#addRegionOptions').prop('disabled',true).css('background-color','#ccc');
				$('#emeaTable').find(':input').prop("disabled", true);
				$('#emeaswTable').find(':input').prop("disabled", true);
				$('#nalacTable').find(':input').prop("disabled", true);
				$('#apacTable').find(':input').prop("disabled", true);
				$('.regionBtns').css('background-color','#ccc');
			} 
			
		}else if(stepNumber === "gtcPopup"){    // Nalac  GTC popup disable edit (3)
			$('#primarySellingUOMGTC').prop("disabled", true).css('background-color','#ccc');
			$('#secondarySellingUOMGTC').prop("disabled", true).css('background-color','#ccc');
			$('#lowestShippableUOMGTC').prop("disabled", true).css('background-color','#ccc');
		}
		
	}
	if(editScreen === "newSOSForEMEA_APAC"){
		$('#productCreateUpdateReason').prop('disabled',true).css('background-color','#ccc');
	}

	if(editScreen == "saveNewSOSForNALAC" || editScreen == "saveNewForCrossFertilization" || editScreen == "saveUpdate" || editScreen == "saveUpdateProcurementData"){
		$("#save").prop("disabled", true);
		$("#saveAndClose").prop("disabled", true);
		$("#getSystemData").prop("disabled", false).removeClass("top-btn");
		$("#getSystemData").addClass("top-cancel-btn");
	}
	
}							// ****** END of Disable functoinality method 


function checkEditScreen(editScreen){
	return (editScreen === "saveNewSOSForNALAC" || editScreen === "saveNewForCrossFertilization" || editScreen === "saveUpdateProcurementData")
}


/////////////////////////-------------------SAVE DATA ON CLOSE starts--------------------------------------------
function saveDataOnClose(isRedirect){
	var json;
	if (stepNumber == 1) {
		gbuFunction(false);

	} 
	else if (stepNumber == 2) {
		brandFunction(false);
	}
	if (form1 != null) {
		json = JSON.stringify(jsonObject);

		if (stepNumber == 1) {
			json = "{" + '"gbuList"' + ":" + json + "}";
		} 
		else if (stepNumber == 2) {
			json = "{" + '"brandList"' + ":" + json + "}";


		} else if (stepNumber == 3) {
			json = "{" + '"productList"' + ":" + json + "}";


		} else if (stepNumber == 4) {
			json = "{" + '"sosList"' + ":" + json + "}";


		} else if (stepNumber == 5) {
			json = "{" + '"regionList"' + ":" + json + "}";

		}
		if(wizardObject[step_03] != ''){
			var l_productList = wizardObject[step_03].productList;
			internalIdString = '';
			for(var iInternalIdCounter = 0 ; iInternalIdCounter < l_productList.length ; iInternalIdCounter++){
					var message = "," + l_productList[iInternalIdCounter].internalProductID;
					internalIdString = internalIdString.concat(message);
			}
			internalIdString = internalIdString + ",";
		}
	}

	$.ajax({
		type 	: "POST",
		url 	: "saveDataOnClose",
		data 	: {
			"stepNumber" 	 : stepNumber,
			"formData" 		 : json,
			"wizardMasterId" : wizardMasterId,
			"internalId"     : internalIdString
		},
		async : false,
		success : function(data) {
			if(isRedirect){
				top.location.href = data
			}else{
				$.alert({
					title	: '',
				    content : 'Data has been saved successfully'
				});
			}
			if (stepNumber == 1 || stepNumber == 2) {
				while (jsonObject.length > 0) {
					jsonObject.pop();
				}
			} 
			console.log("success");
		},
		error : function(response, error, errorThrown) {
			console.log(error + " :-: " + response + " :-: " + errorThrown);
		}
	});

}
/////////////////////////-------------------SAVE DATA ON CLOSE ends--------------------------------------------


/////////////////////////-------------------start of  update functionality in EDIT scenario-------------------- 
function updateProperties(stepNumber){   
	if(editScreen === "saveUpdate"){
		if(stepNumber == 1){
			$('.gbu-block').find('select').each(function () {
			    $(this).prop('disabled', true).css('background-color','#ccc');
			});
			
			$('#productApproverGroup').attr('disabled',false).css('background-color' , '#fff');
		}else if(stepNumber == 2){
			
			$('.brand-block').find('input, textarea, button, select').each(function () {
			    $(this).prop('disabled', true).css('background-color','#ccc');
			});
			$('#shelfLife').prop('disabled',false).css('background-color' , '#fff');
			$('#inventoryFamily').prop('disabled',false).css('background-color' , '#fff');
			$('#inventoryCategory').prop('disabled',false).css('background-color' , '#fff');
			$('#launchYear').prop('disabled',false).css('background-color' , '#fff');
			$('#ansellStandardUOM').prop('disabled',false).css('background-color' , '#fff');
			$('#apsPSPProductFlag').css('background-color','#ccc');
			$('#costApproved').css('background-color','#ccc');
		}else if(stepNumber == 3){
			$('.duplicatebtn').hide();
			$('.deletebtn').hide();
			$('#addProduct').hide();
			$('#generateID').hide();
			$('#add-another-btns').remove();
			$('#size').prop('disabled', true).css('background-color','#ccc');
			$('#eProductIdToggleButton').prop('disabled', true);
			$('#eProductIdOverride').prop('disabled',true).css('background-color','#ccc');
			if(messageMeasuresName.length > 0){
				$('#display').find('input').each(function () {
					$(this).prop('disabled', true);
				});
				var uomLength = $('#display tbody tr').length;
				var uomCounter = 0;
				for (var iCounterUOM = 0; iCounterUOM < uomLength ; iCounterUOM++ ){
					
					var uomName = $('#display tbody tr td')[uomCounter].innerText;
					uomCounter= uomCounter + 5;
					if(uomName === "Box"){
						$('.Box').find('input').each(function () {
						    $(this).prop('disabled', false);
						});
					}
				}
			}
			$('#measures .Gross').attr('disabled',true);
			$('#measures .Pack').attr('disabled',true);
			$('#measures .Retail_Pack').attr('disabled',true);
			$('#measures .Bundle').attr('disabled',true);
			$('#measures .Dozen').attr('disabled',true);
			$('#measures .Kit').attr('disabled',true);
				
		}else if(stepNumber == 4){
			
			$('.sosBtns').find('input').each(function () {
			    $(this).prop('disabled', true);
			});
			$('.sosBtns').css('background-color','#ccc');
			$('.sosLinkClass').hide();
		
		}else if(stepNumber == 5){
			$('#addRegionOptions').prop('disabled',true).css('background-color','#ccc');
			$('#gtcTable').find(':input').prop("disabled", true);
			$('#emeaswTable').find(':input').prop("disabled", true);
			$('#nalacTable').find(':input').prop("disabled", true);
			$('#apacTable').find(':input').prop("disabled", true);
			$('.regionBtns').css('background-color','#ccc');
			$('.gtcBtns').css('background-color','#ccc');
			$('#primarySellingUOMEMEA').prop('disabled', true);
		}
	}
	
}				 
////////////////////////////------------------------ END of  update functionality in EDIT scenario ------------------------

////////////////////////// ---------------------------------- Cancel Data ---------------------------------------------------
function cancelData(){
	
	var cancelDataAction;
	if(editScreen != '' && editScreen != undefined && editScreen != 'copyProduct' &&  editScreen != 'newSOSForEMEA_APAC'){
		cancelDataAction = confirm(cancelForUpdate + lineBreak + 'Do you still want to proceed?');
	}else{
		cancelDataAction = confirm(cancelForCreate + lineBreak + 'Do you still want to proceed?');
	}
	
	if(cancelDataAction == false){
		return;
	}
	if(stepNumber == 3){
		var internalIdList = '';
		for (var iProductListCounter = 0; iProductListCounter < jsonObject.length; iProductListCounter++) {
			var l_productList = jsonObject[iProductListCounter].internalProductID+",";
			internalIdList = internalIdList.concat(l_productList);
		}
	}else if (wizardObject[step_03].productList == undefined || wizardObject[step_03].productList.length > 0) {
		var l_productList = wizardObject[step_03].productList;
		var internalIdList = '';
		if(l_productList != undefined){
			for (var iInternalIdCounter = 0; iInternalIdCounter < l_productList.length; iInternalIdCounter++) {
				var message =  l_productList[iInternalIdCounter].internalProductID+",";
				internalIdList = internalIdList.concat(message);
			}
		}
	}else{
			internalIdList = '';
	}
	$.ajax({
		type 	: "POST",
		url 	: "cancelData",
		data 	: {
			internalId     : internalIdList
		},
	
		async : false,
		success : function(data) {
			top.location.href = data
		},
		error : function(response, error, errorThrown) {
			console.log(error + " :-: " + response + " :-: " + errorThrown);
		}
	});
	
} // ************* END of close data

function getAllSystemData(){
	if (wizardObject[step_03].length > 0 || wizardObject[step_03].length == undefined) {
		var l_productList = wizardObject[step_03].productList;
		var internalIdList = '';
		for (var iInternalIdCounter = 0; iInternalIdCounter < l_productList.length; iInternalIdCounter++) {
			var message =  l_productList[iInternalIdCounter].internalProductID+",";
			internalIdList = internalIdList.concat(message);
		}
	}else{
		internalIdList = '';
	}
	
	window.open("getAllSystemData?internalId="+internalIdList,"_blank");
}

function workflowStatusDisableIcon(){
	$('#addProduct').hide();
	$('.duplicatebtn').hide();
	$('.deletebtn').hide();
	$('#generateID').hide();	
}